{
  "category": "FIX",
  "shortDescription": "Fix DXF overlay draw mode — clicks now register on canvas",
  "problem": "Τα εργαλεία σχεδίασης overlay στον DXF Viewer ήταν εντελώς νεκρά. Κλικ στον καμβά δεν δημιουργούσε κανένα σημείο, κανένα polygon, καμία καταγραφή στην κονσόλα.",
  "cause": "Στο CanvasSection.tsx (γρ. 1239), η συνθήκη `overlayMode === 'draw' && activeTool !== 'select'` αξιολογούνταν ΠΑΝΤΑ σε false. Όταν ο χρήστης πατά 'Draw' στο overlay toolbar (OverlayModeButtons.tsx), μόνο το overlayMode αλλάζει σε 'draw' — το activeTool παραμένει 'select'. Επομένως activeTool !== 'select' = false, και ο κώδικας σχεδίασης δεν εκτελούνταν ποτέ.",
  "filesChanged": [
    "src/subapps/dxf-viewer/components/dxf-layout/CanvasSection.tsx (overlay draw condition fix)"
  ],
  "solution": "Αφαίρεση του `activeTool !== 'select'` guard από τη συνθήκη overlay draw. Η συνθήκη `overlayMode === 'draw'` είναι αρκετή — είναι true μόνο όταν ο χρήστης ενεργοποίησε ρητά το overlay draw mode μέσω του toolbar button.",
  "testing": "npx tsc --noEmit — 0 TS errors",
  "notes": "Επίσης στο ίδιο session: Διόρθωση photo upload bugs σε Company contacts (disabled state propagation, handler wiring, optimistic photo state) + αποκατάσταση individual-config.ts που είχε αδειάσει κατά λάθος.",
  "contributors": {
    "user": "Γιώργος Παγώνης",
    "assistant": "Claude Opus 4.6",
    "sessionDate": "2026-02-13"
  },
  "relatedBackups": [],
  "commits": [
    {
      "hash": "e823b131",
      "message": "fix: extract multiplePhotoURLs from PhotoSlots before removing non-serializable data"
    },
    {
      "hash": "d311a00a",
      "message": "fix(dxf-viewer): overlay draw mode clicks now work — remove activeTool guard"
    }
  ]
}
