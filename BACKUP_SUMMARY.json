{
  "category": "FEATURE",
  "shortDescription": "Contact Relationship Auto-Save UX + ADR Documentation",
  "problem": "Users filling relationship form data and clicking main contact Save without clicking the separate Add button inside the relationship form — data was silently lost. 5+ debugging sessions before discovering this was a UX issue, not a technical bug.",
  "cause": "Two independent save actions existed (relationship Add vs contact Save) without clear guidance. Users expected the main Save to cover everything.",
  "filesChanged": [
    "src/utils/pending-relationship-guard.ts",
    "src/components/contacts/relationships/ContactRelationshipManager.tsx",
    "src/components/contacts/details/ContactDetails.tsx",
    "src/components/contacts/relationships/RelationshipForm.tsx",
    "src/components/contacts/relationships/hooks/useRelationshipForm.ts",
    "src/components/contacts/relationships/context/RelationshipProvider.tsx",
    "src/services/contact-relationships/ContactRelationshipService.ts",
    "src/services/contact-relationships/adapters/FirestoreRelationshipAdapter.ts",
    "src/services/contact-relationships/core/RelationshipCRUDService.ts",
    "src/i18n/locales/el/contacts.json",
    "src/i18n/locales/en/contacts.json",
    "docs/centralized-systems/reference/adrs/ADR-178-contact-relationship-auto-save-ux.md",
    "docs/centralized-systems/reference/adr-index.md"
  ],
  "solution": "1. Created PendingRelationshipGuard (Service Locator pattern module singleton) that tracks dirty state of relationship form. 2. ContactRelationshipManager registers its handleSubmit callback on mount. 3. ContactDetails.handleSaveEdit() calls submitPending() before saving contact — auto-submits pending relationship. 4. Added amber warning banner in RelationshipForm when data is pending. 5. Fixed stack overflow in isEmploymentRelationship (inline check). 6. Removed 40+ diagnostic console.logs from 6 files. 7. Added i18n keys for pendingReminder (EL+EN). 8. Created ADR-178 with full flow documentation.",
  "testing": "TypeScript compilation: 0 errors. Verified all DIAG console.logs removed. ADR-178 created with complete architecture documentation.",
  "notes": "Root cause of 5+ sessions of 'relationships dont work' was a UX issue — user never clicked Add button. The PendingRelationshipGuard now bridges this gap. Stack overflow in production was caused by isEmploymentRelationship import (likely circular dependency in tree-shaking).",
  "contributors": {
    "user": "Γιώργος Παγώνης",
    "assistant": "Claude Code (Anthropic AI)",
    "sessionDate": "2026-02-13"
  },
  "relatedBackups": [],
  "commits": [
    { "hash": "49b80a4a", "message": "feat(relationships): auto-save pending relationships on contact save" },
    { "hash": "04cd1843", "message": "docs: add ADR-178 — Contact Relationship Auto-Save UX (PendingRelationshipGuard)" }
  ]
}
