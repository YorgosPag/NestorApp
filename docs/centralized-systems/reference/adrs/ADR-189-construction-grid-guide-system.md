# ADR-189: Construction Grid & Guide System (Κάνναβος & Οδηγοί)

| Field | Value |
|-------|-------|
| **Status** | DRAFT — Συλλογή απαιτήσεων ✅ ΟΛΟΚΛΗΡΩΘΗΚΕ. Επόμενο: Σχεδιασμός υλοποίησης |
| **Date** | 2026-02-19 |
| **Module** | DXF Viewer / Grid System |
| **Inspiration** | LH Λογισμική — Fespa / Τέκτων (Master) |
| **Priority** | TBD |

---

## 1. Σκοπός

Σχεδιασμός ενός συστήματος **Κάνναβου / Οδηγών** (Construction Grid & Guides) για τον DXF Viewer,
εμπνευσμένο από τη λογική του Fespa/Τέκτων της LH Λογισμική.

Ο κάνναβος χρησιμεύει ως **δομικό πλέγμα αναφοράς** για τη σωστή τοποθέτηση
αρχιτεκτονικών και στατικών στοιχείων σε μία κάτοψη κτιρίου.

---

## 2. Γνωστές Πληροφορίες (από έρευνα)

### 2.1 Τι είναι ο Κάνναβος

- Πλέγμα γραμμών (**περασιών**) με **διακριτά και ενεργά σημεία τομής**
- Τα σημεία τομής ονομάζονται **σημεία έλξης (snap points)**
- Οι κορυφές δομικών στοιχείων (πλάκες, υποστυλώματα, τοιχώματα) **έλκονται αυτόματα** στα snap points κατά την εισαγωγή ή μετακίνηση

### 2.2 Αυτόματη Ονομασία Αξόνων

- Ο κάνναβος αναθέτει αυτόματα **αλφαριθμητικές θέσεις** (π.χ. A1, B1, Γ2...)
- Εμφανίζεται σε: κατόψεις, τομές, λεπτομέρειες υποστυλωμάτων, αναπτύγματα δοκών
- Επιτρέπει αναγνώριση θέσης στο εργοτάξιο απευθείας από το σχέδιο

### 2.3 Εξέλιξη Ονομασίας (Fespa)

| Έκδοση | Ονομασία | Ρόλος |
|--------|----------|-------|
| Fespa ≤ 6.x | **Κάνναβος** | Βασικό πλέγμα με snap points |
| Fespa 7.x+ | **Οδηγός** (Guide) | Μετονομασία του παλιού κάνναβου |
| Fespa 7.x+ | **Κάνναβος** (νέος) | Ενεργή οντότητα — αυτόματη ονομασία αξόνων |

### 2.4 Ρυθμίσεις (μερικές)

- **Βήμα (spacing)**: Απόσταση μεταξύ γραμμών πλέγματος
- **Κύριος κάνναβος**: Κύρια γραμμή πλέγματος
- **Βοηθητικός κάνναβος**: Ενδιάμεσες γραμμές
- **Βήμα zoom**: Παράμετρος μεγέθυνσης ρόδας mouse
- **Toggle snap**: Πλήκτρο **Delete** ή **S** κατά τη σχεδίαση

### 2.5 Σημεία Έλξης (Snap Points)

- ΟΧΙ μόνο στον κάνναβο — **όλες** οι οντότητες (στατικές, γραμμικές) διαθέτουν snap points
- Υποστηρίζονται: endpoints, intersections, midpoints κ.λπ.
- Αυτό ήδη υπάρχει στο DXF Viewer μας (ProSnapEngineV2, 13 snap types)

---

## 3. Πληροφορίες από Γιώργο (εμπειρία Τέκτων)

> Περιγραφή λειτουργίας βάσει πρακτικής γνώσης του Τέκτονα/Fespa.

### 3.1 Toolbar & Εντολές

Στην κεντρική εργαλειοθήκη υπάρχει πλήκτρο **"Οδηγός"**. Πατώντας το ανοίγει μενού:

| # | Εντολή | Κλικ | Τι κάνει |
|---|--------|------|----------|
| 1ο | **Περασιά X** | **1 κλικ** | Κατακόρυφη γραμμή — πολύ μεγάλο μήκος ("άπειρη") |
| 2ο | **Περασιά Z** | **1 κλικ** | Οριζόντια γραμμή — πολύ μεγάλο μήκος ("άπειρη") |
| 3ο | **Περασιά XZ** | **3 κλικ** | Λοξή/ελεύθερη γωνία — **πεπερασμένο μήκος** (ο χρήστης ορίζει αρχή, κατεύθυνση, τέλος) |
| 4ο | **Κάθετη** | **2 βήματα** | Δημιουργεί γραμμή **κάθετη σε υφιστάμενη περασιά** — απεριόριστο μήκος |
| 5ο | **Σε Τμήματα** | **2 κλικ + input** | Χωρίζει απόσταση σε ισαπέχοντα snap points (X markers) — χωρίς γραμμές |
| 6ο | **Ανά Απόσταση** | **2 κλικ + input** | Snap points ανά σταθερή απόσταση (π.χ. ανά 10μ) — χωρίς γραμμές |
| 7ο | **Σε Τμήματα Τόξου** | **1 κλικ + input** | Υποδιαιρεί υφιστάμενο τόξο σε ισαπέχοντα X markers |
| 8ο | **Ανά Απόσταση Τόξου** | **1 κλικ + input** | X markers ανά σταθερή απόσταση πάνω σε τόξο |
| 9ο | **Τομή Κύκλων** | **2 κλικ** | X markers στα σημεία τομής δύο κύκλων |
| 10ο | **Τομή Τόξου & Ευθείας** | **2 κλικ** | X markers στα σημεία τομής γραμμής με τόξο/κύκλο |
| 11ο | **Παράλληλοι** ⭐ | **1 κλικ + keyboard** | Παράλληλη γραμμή σε σταθερή απόσταση — πολύ συχνή χρήση |
| 12ο | **Διαγραφή Περασιάς** | **1 κλικ** | Διαγράφει μία γραμμή-οδηγό |
| 13ο | **Προσθήκη Σημείου** | **N κλικ** | Προσθέτει μεμονωμένα X markers ελεύθερα |
| 14ο | **Διαγραφή Σημείου** | **1 κλικ** | Διαγράφει ένα X marker |

**Βασική λογική**: Κάθε "περασιά" (pass/run) είναι μία **μεμονωμένη, πολύ μεγάλη γραμμή-οδηγός** που τοποθετείται με κλικ. Δεν δημιουργείται ολόκληρο πλέγμα με μία εντολή — ο χρήστης τοποθετεί μία-μία τις γραμμές-οδηγούς.

### 3.2 Visual Appearance (από screenshot Τέκτονα)

Παρατηρήσεις από πραγματικό screenshot του Fespa-Tekton:

| Χαρακτηριστικό | Περιγραφή |
|----------------|-----------|
| **Χρώμα περασιάς** | Λεπτή, ανοιχτόχρωμη γραμμή (γκρι/λευκή) πάνω σε σκούρο φόντο |
| **Μήκος** | Εκτείνεται σε **ολόκληρο το viewport** και πέρα |
| **Πάχος** | Πολύ λεπτή (1px) — ξεκάθαρα βοηθητική, όχι δομική |
| **Σταυρόνημα** | Δύο λευκές γραμμές σε σχήμα σταυρού (+) — αυτό είναι ο **cursor**, ΟΧΙ περασιές |
| **Status bar** | Δείχνει: `"Δώστε τις κατά Χ περασιές"` — prompt για τοποθέτηση |
| **Συντεταγμένες** | `X=0.50` — η τρέχουσα θέση X σε μέτρα |
| **Snap step** | `Sn=0.05` — βήμα snap 5cm |
| **Floors** | Tabs ορόφων (Όροφ.-1, Όροφ.0, Όροφ.1 ... Όροφ.22) — περασιές ανά όροφο |

### 3.3 Ροή Τοποθέτησης Περασιάς (workflow)

Βήμα-βήμα, όπως περιέγραψε ο Γιώργος:

**Περασιά X (κατακόρυφη)** — 1ο πλήκτρο στο μενού:
1. Επιλογή "Περασιά X" από αριστερό μενού
2. Μετακίνηση σταυρονήματος στην οθόνη
3. **Ένα κλικ** → δημιουργείται κατακόρυφη λεπτή γραμμή
4. Μπορείς να συνεχίσεις με επιπλέον κλικ για περισσότερες περασιές

**Περασιά Z (οριζόντια)** — 2ο πλήκτρο στο μενού:
- **Ακριβώς ίδια συμπεριφορά** με την Περασιά X
- Επιλογή → μετακίνηση σταυρονήματος → **ένα κλικ** → οριζόντια γραμμή

**Κοινό X/Z**: Και οι δύο τύποι δημιουργούνται με **ένα μόνο κλικ**.

**Περασιά XZ (λοξή)** — 3ο πλήκτρο στο μενού:
1. **1ο κλικ**: "Επιλέξτε το ένα άκρο της περασιάς" → ορίζει αρχή
2. **2ο κλικ**: "Επιλέξτε άλλο ένα σημείο της περασιάς" → ορίζει κατεύθυνση/γωνία
3. **3ο κλικ**: "Επιλέξτε το τέλος της περασιάς" → ορίζει μήκος/τέλος

**Βασική διαφορά**: Οι X/Z περασιές είναι **"άπειρες"** (πολύ μεγάλες), ενώ η XZ περασιά έχει **πεπερασμένο μήκος** που ορίζεται από τα 3 κλικ.

### 3.4 Οπτικές Ενδείξεις (από 2ο screenshot)

Στο screenshot φαίνονται και οι 3 τύποι περασιών μαζί:
- **Περασιά X**: κατακόρυφη, εκτείνεται σε ολόκληρο το ύψος
- **Περασιά Z**: οριζόντια, εκτείνεται σε ολόκληρο το πλάτος
- **Περασιά XZ**: διαγώνια, με **ορατή αρχή και τέλος** (πεπερασμένο μήκος)

Πράσινες ενδείξεις κατά τη δημιουργία:
- **+** (σταυρός) = σταυρόνημα / cursor
- **○** (κύκλος) = σημείο snap / σημείο αναφοράς
- **X** = σημείο κλικ / ένδειξη τοποθέτησης

### 3.5 Snap Points στα Σημεία Τομής Περασιών

Όταν τα snaps είναι ενεργοποιημένα:

| Κατάσταση | Ένδειξη | Περιγραφή |
|-----------|---------|-----------|
| **Ανενεργό** (σταυρόνημα μακριά) | Μικρό λευκό **X** | Μόνιμα ορατό στα σημεία τομής περασιών |
| **Ενεργό** (σταυρόνημα κοντά) | Μικρό λευκό **+** | Το X μετατρέπεται σε + όταν ενεργοποιείται η έλξη |

**Βασική αρχή**: Κάθε σημείο τομής δύο περασιών (ανεξαρτήτως τύπου — X∩Z, X∩XZ, Z∩XZ) γίνεται **αυτόματα snap point** με μόνιμη οπτική ένδειξη.

**Λεπτομέρεια UX**: Η εναλλαγή X → + δίνει **οπτική ανατροφοδότηση** στον χρήστη ότι η έλξη ενεργοποιήθηκε, χωρίς να χρειάζεται να κοιτάξει αλλού (π.χ. status bar).

### 3.6 Κάθετη (4ο πλήκτρο)

Δημιουργεί νέα γραμμή **κάθετη σε υφιστάμενη περασιά**, με απεριόριστο μήκος.

**Workflow (2 βήματα):**
1. **Επιλογή υφιστάμενης**: "Επιλέξτε γραμμή-οδηγό για προσθήκη καθέτου επ' αυτής"
   - Μετακινείς το σταυρόνημα κοντά σε μια υφιστάμενη περασιά
   - Η περασιά **χρωματίζεται** (highlight) όταν πλησιάζεις — οπτική ένδειξη επιλογής
   - Κλικ → επιλέγεται η περασιά
2. **Τοποθέτηση καθέτου**: "Επιλέξτε σημείο για προσθήκη"
   - Κλικ σε οποιοδήποτε σημείο → δημιουργείται νέα γραμμή **κάθετη** στην επιλεγμένη
   - Η νέα γραμμή έχει **απεριόριστο μήκος** (όπως οι X/Z)

**Χρήση**: Ιδανική για γρήγορη δημιουργία κάθετων αξόνων σε λοξές περασιές (XZ), χωρίς να υπολογίζεις γωνία χειροκίνητα.

### 3.7 Σε Τμήματα (5ο πλήκτρο)

Χωρίζει μια απόσταση σε **ισαπέχοντα snap points** (μικρά X markers). **Δεν** δημιουργεί γραμμές — μόνο σημεία έλξης.

**Workflow (2 κλικ + input):**
1. **1ο κλικ**: "Επιλέξτε το πρώτο σημείο" → ορίζει αρχή
2. **2ο κλικ**: "Επιλέξτε το 2ο σημείο" → ορίζει τέλος
3. **Popup dialog**: "Δώστε αριθμό τμημάτων" → input πεδίο + OK/Ακύρωση
4. **Αποτέλεσμα**: Δημιουργούνται **ισαπέχοντα X markers** ανάμεσα στα δύο σημεία

**Παράδειγμα**: 2 κλικ + αριθμός τμημάτων = 3 → δημιουργούνται **3 X markers**:
- Ένα στο 1ο κλικ (αρχή)
- Ένα στο κέντρο (ισαπέχον)
- Ένα στο 2ο κλικ (τέλος)

**Σημαντικό**: Τα X markers λειτουργούν ακριβώς όπως τα snap points τομής περασιών (§3.5) — μόνιμα ορατά, X → + κατά την έλξη. Λειτουργεί ακόμα και σε **κενή οθόνη** (δεν χρειάζεται υφιστάμενες περασιές).

**Διόρθωση — συμπεριφορά με υφιστάμενους οδηγούς**: Όταν υπάρχουν ήδη γραμμές-οδηγοί με σημεία τομής (X markers), η εντολή "Σε Τμήματα" μπορεί να χρησιμοποιηθεί μεταξύ δύο σημείων τομής. Τα νέα X markers τοποθετούνται **πάνω ακριβώς στον υφιστάμενο οδηγό** μεταξύ των δύο σημείων.

### 3.8 Ανά Απόσταση (6ο πλήκτρο)

Δημιουργεί snap points (X markers) ανά **σταθερή απόσταση** μεταξύ δύο σημείων.

**Workflow (2 κλικ + input):**
1. **1ο κλικ**: "Επιλέξτε το πρώτο σημείο" → ορίζει αρχή
2. **2ο κλικ**: "Επιλέξτε το δεύτερο σημείο" → ορίζει τέλος
3. **Popup dialog**: "Δώστε μήκος" → input σε μέτρα (π.χ. 10)
4. **Αποτέλεσμα**: X markers ανά σταθερή απόσταση, από αρχή μέχρι τέλος

**Παράδειγμα**: 2 κλικ + μήκος 10μ → X markers κάθε 10 μέτρα:
- 1ο X στο πρώτο κλικ (αρχή)
- 2ο X στα 10μ
- 3ο X στα 20μ
- ...τελευταίο X στο δεύτερο κλικ (τέλος)
- **ΣΗΜΕΙΩΣΗ**: Η τελευταία απόσταση μπορεί να είναι **μικρότερη** αν η συνολική απόσταση δεν είναι ακριβές πολλαπλάσιο

**Διαφορά "Σε Τμήματα" vs "Ανά Απόσταση":**

| | Σε Τμήματα (5ο) | Ανά Απόσταση (6ο) |
|--|------------------|-------------------|
| **Input** | Αριθμός τμημάτων | Μήκος σε μέτρα |
| **Αποτέλεσμα** | Πάντα ισαπέχοντα | Σταθερή απόσταση, τελευταίο τμήμα μπορεί να μικρότερο |
| **Παράδειγμα** | "3 τμήματα" → 2 ενδιάμεσα σημεία | "ανά 10μ" → σημεία κάθε 10μ |

### 3.9 Σε Τμήματα Τόξου (7ο πλήκτρο)

Υποδιαιρεί ένα υφιστάμενο τόξο/κύκλο σε ισαπέχοντα snap points.

**Workflow:**
1. "Επιλέξτε τόξο για πρόσθεση οδηγού" → κλικ σε υφιστάμενο τόξο
2. Popup: "Δώστε αριθμό τμημάτων" → αριθμός + OK
3. X markers εμφανίζονται **πάνω στο τόξο** σε ισαπέχουσες θέσεις

### 3.10 Ανά Απόσταση Τόξου (8ο πλήκτρο)

Ίδια λογική με "Ανά Απόσταση" αλλά πάνω σε τόξο/κύκλο.

**Workflow:**
1. "Επιλέξτε τόξο για πρόσθεση οδηγού" → κλικ σε τόξο
2. Εμφανίζεται δυναμική γραμμή από το άκρο του τόξου μέχρι το σταυρόνημα
3. Prompt: "Δώστε μήκος" → αριθμός σε μέτρα
4. X markers ανά σταθερή απόσταση πάνω στο τόξο

### 3.11 Τομή Κύκλων (9ο πλήκτρο)

Βρίσκει αυτόματα τα σημεία τομής δύο κύκλων.

**Workflow:**
1. "Επιλέξτε τον πρώτο κύκλο" → κλικ
2. "Επιλέξτε τον δεύτερο κύκλο" → κλικ
3. X markers εμφανίζονται στα **σημεία τομής** των δύο κύκλων (0, 1 ή 2 σημεία)

### 3.12 Τομή Τόξου & Ευθείας (10ο πλήκτρο)

Βρίσκει τα σημεία τομής γραμμής με τόξο ή κύκλο.

**Workflow:**
1. "Επιλέξτε γραμμή" → κλικ σε ευθεία
2. "Επιλέξτε τόξο" → κλικ σε τόξο **ή** κύκλο (λειτουργεί και στα δύο)
3. X markers στα σημεία τομής

### 3.13 Παράλληλοι (11ο πλήκτρο) ⭐ ΠΟΛΥ ΣΥΧΝΗ ΧΡΗΣΗ

Δημιουργεί γραμμή-οδηγό **παράλληλη** σε υφιστάμενη, σε καθορισμένη απόσταση.

**Workflow:**
1. "Επιλέξτε γραμμή" → μετακίνηση σταυρονήματος κοντά σε οδηγό → η γραμμή **φωτίζεται** (highlight) → κλικ
2. Εμφανίζεται **δυναμική γραμμή** (real-time preview) που ενώνει το σταυρόνημα με τον υφιστάμενο οδηγό
3. Prompt: "Δώστε απόσταση" → **πληκτρολόγηση στο keyboard + Enter** (ΟΧΙ popup dialog)
4. Δημιουργείται παράλληλη γραμμή στην πλευρά που βρίσκεται το σταυρόνημα

**UX λεπτομέρεια**: Η πλευρά (αριστερά/δεξιά ή πάνω/κάτω) καθορίζεται από τη **θέση του σταυρονήματος** σε σχέση με τον υφιστάμενο οδηγό. Η δυναμική γραμμή δίνει real-time ανατροφοδότηση.

### 3.14 Διαγραφή Περασιάς (12ο πλήκτρο)

**Workflow:**
1. "Επιλέξτε γραμμή για διαγραφή" → κλικ σε γραμμή-οδηγό → διαγράφεται

### 3.15 Προσθήκη Σημείου (13ο πλήκτρο)

Προσθέτει μεμονωμένα X markers (snap points) ελεύθερα στον καμβά.

**Workflow:**
1. "Δώσε νέο σημείο οδηγού" → κλικ → X marker
2. Συνεχίζεις με όσα κλικ θέλεις → κάθε κλικ = νέο X marker

### 3.16 Διαγραφή Σημείου (14ο πλήκτρο)

**Workflow:**
1. "Επιλέξτε σημείο οδηγού για διαγραφή" → μετακίνηση κοντά σε X marker
2. Το X μετατρέπεται σε + (snap feedback) → κλικ → διαγράφεται

### 3.17 Γενικές Ιδιότητες Οδηγών

| Ιδιότητα | Τιμή |
|----------|------|
| **Εκτύπωση** | ❌ ΔΕΝ εκτυπώνονται — είναι **μόνο βοηθητικές** |
| **Αποθήκευση** | ✅ Σώζονται μαζί με το σχέδιο |
| **Εμφάνιση** | Πολύ λεπτές, αχνό χρώμα — ο χρήστης **αντιλαμβάνεται αμέσως** ότι είναι βοηθητικές |
| **Μαζική διαγραφή** | ✅ Εντολή "Νέος Οδηγός" στο κεντρικό μενού → **διαγράφει ΟΛΕΣ** τις γραμμές + σημεία ταυτόχρονα |

**ΣΗΜΑΝΤΙΚΗ ΔΙΕΥΚΡΙΝΙΣΗ**: Στο screenshot:
- Η γραμμή κυκλωμένη με **πράσινο** = η **περασιά** (μόνο μία δημιουργήθηκε)
- Οι δύο λευκές γραμμές σε σχήμα **+** = το **σταυρόνημα** (cursor), ΟΧΙ περασιές

---

## 4. Ανοιχτά Ερωτήματα (προς συμπλήρωση)

> Επόμενες ερωτήσεις — ο Γιώργος θα απαντήσει σταδιακά.

### 4.1 Τοποθέτηση Περασιών

- [x] **Q1**: Ακριβείς συντεταγμένες; → **Μόνο κλικ**. Αν snap ενεργό, η περασιά τοποθετείται στο πλησιέστερο snap point.
- [x] **Q2**: Μετακίνηση (drag) μετά; → **ΟΧΙ στον Τέκτονα**. ✅ Θα προστεθεί στη δική μας υλοποίηση (βελτίωση).
- [x] **Q3**: Αυτόματη ονομασία; → **Ανώνυμες** στον Τέκτονα. ✅ Θα προστεθούν labels (βελτίωση).

### 4.2 Εμφάνιση

- [x] **Q4**: Τι χρώμα/στυλ έχει η περασιά; → **Πολύ λεπτή, αχνό χρώμα** — ξεκάθαρα βοηθητική
- [x] **Q5**: Ονομασία στις άκρες; → **ΟΧΙ στον Τέκτονα**. ✅ Θα προστεθούν axis bubbles (βελτίωση).
- [x] **Q6**: Εκτυπώνεται στα σχέδια ή είναι μόνο βοηθητική; → **ΔΕΝ εκτυπώνεται** — μόνο βοηθητική

### 4.3 Snap & Αλληλεπίδραση

- [x] **Q7**: Οι περασιές έχουν snap points; → **ΝΑΙ**, τα σημεία τομής είναι μόνιμα snap points
- [x] **Q8**: Όταν δύο περασιές τέμνονται, το σημείο τομής γίνεται ειδικό snap point; → **ΝΑΙ** (βλ. §3.5)
- [x] **Q9**: Μετακίνηση στοιχείων μαζί; → **ΟΧΙ στον Τέκτονα** — ανεξάρτητα. Πιθανή μελλοντική βελτίωση (optional link).

### 4.4 Υπόλοιπες εντολές μενού

- [x] **Q10**: Ποιες είναι οι υπόλοιπες εντολές; → **14 συνολικά** — πλήρης λίστα στο §3.1
- [ ] **Q11**: Υπάρχει εντολή "Κάνναβος" που δημιουργεί αυτόματα ολόκληρο πλέγμα; (Ή μόνο μεμονωμένες περασιές;)

### 4.5 Ειδικές Περιπτώσεις

- [x] **Q12**: Υποστηρίζονται λοξές περασιές (γωνία ≠ 0° ή 90°); → **ΝΑΙ**, μέσω "Περασιά XZ" (3 κλικ)
- [ ] **Q13**: Πόσες περασιές μπορείς να βάλεις; (Δεκάδες; Χωρίς όριο;) — πιθανώς χωρίς όριο
- [ ] **Q14**: Μπορείς να ομαδοποιήσεις περασιές σε "κάνναβο" (group); — πιθανώς ΟΧΙ στον Τέκτονα

---

## 4. Βελτιώσεις πέρα από τον Τέκτονα (ΕΓΚΕΚΡΙΜΕΝΕΣ)

> Λειτουργίες που **δεν υπάρχουν** στον Τέκτονα αλλά θα υλοποιηθούν στο δικό μας σύστημα.

### 4.1 Εγκεκριμένες Βελτιώσεις (Γιώργος ✅)

| # | Βελτίωση | Περιγραφή | Προτεραιότητα |
|---|----------|-----------|---------------|
| B1 | **Axis Labels με Bubbles** | Κυκλάκια στις άκρες περασιών (Α, Β, Γ / 1, 2, 3) — πρότυπο Revit/AutoCAD | ⭐ Υψηλή |
| B2 | **Αυτόματη δημιουργία πλέγματος** | Εντολή "Κάνναβος": (α) ισαπέχουσες αποστάσεις ή (β) ανισαπέχουσες (π.χ. 5μ, 3μ, 7μ). Λειτουργεί ως **προσωρινός κάνναβος** δίπλα στον κεντρικό grid | ⭐ Υψηλή |
| B3 | **Διαστάσεις μεταξύ περασιών** | Annotations απόστασης (π.χ. "5.00μ") με **toggle** εμφάνισης/απόκρυψης | Μεσαία |
| B4 | **Κλείδωμα οδηγών (Lock)** | Lock/unlock ανά περασιά για αποφυγή κατά λάθος διαγραφής | Μεσαία |
| B5 | **Drag μετακίνηση** | Drag & drop για μετακίνηση τοποθετημένης περασιάς με real-time preview | ⭐ Υψηλή |
| B6 | **Χρώματα / Στυλ ανά ομάδα** | Χρήση υφιστάμενων color pickers στις ρυθμίσεις DXF. Νέα ενότητα για guide colors | ⭐ Υψηλή |
| B8 | **Οδηγός από υφιστάμενη οντότητα** | Κλικ σε DXF entity (τοίχος, γραμμή) → αυτόματη περασιά πάνω του | Μεσαία |
| B9 | **Ακτινικοί οδηγοί** | Ακτίνες από κεντρικό σημείο ανά γωνία (30°/45°/60°) — κυκλικές κατασκευές | Μεσαία |
| B12 | **Snap μεσαίου** | Αυτόματο snap στο μέσον μεταξύ δύο παράλληλων περασιών | Μεσαία |

### 4.2 Οπτική Διαφοροποίηση Οδηγών (ΚΡΙΣΙΜΟ)

> Ο Γιώργος τονίζει: οι γραμμές-οδηγοί πρέπει να είναι **αμέσως αναγνωρίσιμες** ως βοηθητικές.

**Τεχνικές rendering:**

| Τεχνική | Περιγραφή | Εφαρμογή |
|---------|-----------|----------|
| **Sub-pixel πάχος** | Line width < 1px (π.χ. 0.5px) — πιο λεπτή από οποιαδήποτε DXF entity | Canvas strokeWidth |
| **Χαμηλή αδιαφάνεια** | Alpha 0.25–0.40 — ημιδιαφανείς, δεν κυριαρχούν | globalAlpha ή rgba |
| **Dashed pattern** | Μικρές παύλες (π.χ. [4, 4]) — οπτικά διαφορετικές από solid entity γραμμές | setLineDash |
| **Ξεχωριστό χρώμα** | Muted χρώμα (π.χ. cyan, pale blue) — ΟΧΙ το ίδιο με entities | Configurable via settings |
| **Σταθερό πάχος στο zoom** | Οι οδηγοί παραμένουν 0.5px ανεξαρτήτως zoom level — δεν παχαίνουν | Inverse scale transform |

**Αρχή**: Ο χρήστης πρέπει να ξεχωρίζει αμέσως τι είναι **δομικό στοιχείο** και τι είναι **βοηθητικός οδηγός**, ακόμα και αν το σχέδιο είναι γεμάτο γραμμές.

### 4.3 Εγκεκριμένες Πρόσθετες Βελτιώσεις (Γιώργος ✅)

| # | Βελτίωση | Περιγραφή | Προτεραιότητα |
|---|----------|-----------|---------------|
| B7 | **Ομαδοποίηση (Groups)** | Ομαδοποίηση περασιών σε named groups (π.χ. "Δομικός Κάνναβος", "MEP") | Μεσαία |
| B11 | **Info Panel** | Side panel με ιδιότητες επιλεγμένης περασιάς (θέση, γωνία, μήκος) | Χαμηλή |
| B13 | **Keyboard Shortcuts** | G+X=Περασιά X, G+Z=Περασιά Z, G+P=Παράλληλοι κ.λπ. | ⭐ Υψηλή |
| B14 | **Multi-select οδηγών** | Batch operations: διαγραφή, lock, αλλαγή χρώματος πολλών | Μεσαία |
| B15 | **Toggle ορατότητας** | Κουμπί εμφάνισης/απόκρυψης ΟΛΩΝ των οδηγών (χωρίς διαγραφή) | ⭐ Υψηλή |
| B16 | **Οδηγός σε γωνία** | Κλικ + γωνία (π.χ. 45°) → λοξή περασιά χωρίς 3 κλικ | Μεσαία |
| B17 | **Copy/Offset pattern** | Αντιγραφή ομάδας περασιών με μετατόπιση | Μεσαία |
| B18 | **Coordinate labels** | Labels δίπλα στα X markers (x=5.00, z=3.00) — toggle | Χαμηλή |

### 4.4 Αλληλεπίδραση με Υφιστάμενες Οντότητες (Γιώργος ✅)

> Ιδέα Γιώργου: κλικ σε **οποιαδήποτε υφιστάμενη οντότητα** (γραμμή, τόξο, κύκλος) → popup → επιλογή δημιουργίας οδηγών/σημείων.

#### Για ευθύγραμμα τμήματα (γραμμές, polylines):

| Ενέργεια | Περιγραφή |
|----------|-----------|
| **Snap points κατά μήκος** | Κλικ σε γραμμή → popup "Πλήθος σημείων" → X markers ισαπέχοντα πάνω στην οντότητα |
| **Οδηγός ίδιου μήκους** | Δημιουργία γραμμής-οδηγού ακριβώς πάνω στη γραμμή (ίδιο μήκος) |
| **Οδηγός με επέκταση** | Ίδια κατεύθυνση αλλά **απεριόριστο μήκος** — η γραμμή επεκτείνεται και στις δύο πλευρές |

#### Για κύκλους:

| Ενέργεια | Περιγραφή |
|----------|-----------|
| **Snap points στην περιφέρεια** | Κλικ σε κύκλο → popup "Πλήθος σημείων" → X markers ισαπέχοντα στην περιφέρεια |
| **Ακτινικοί οδηγοί** | Γραμμές-οδηγοί **από το κέντρο** → περνούν από την περιφέρεια → **επεκτείνονται πολύ μακριά** |

#### Για τόξα:

| Ενέργεια | Περιγραφή |
|----------|-----------|
| **Snap points στο τόξο** | Κλικ σε τόξο → popup "Πλήθος σημείων" → X markers πάνω στο τόξο |
| **Ακτινικοί οδηγοί** | Γραμμές από κέντρο τόξου → περνούν από σημεία στο τόξο → επεκτείνονται |

#### Για ορθογώνια (rectangles/polylines):

| Ενέργεια | Περιγραφή |
|----------|-----------|
| **Snap points ανά πλευρά** | Υποδιαίρεση κάθε πλευράς σε N σημεία |
| **Οδηγοί ανά πλευρά** | Γραμμές-οδηγοί πάνω σε κάθε πλευρά με απεριόριστη επέκταση |

**Κοινή αρχή**: Ο χρήστης κάνει κλικ σε **οποιαδήποτε** υφιστάμενη οντότητα → popup με επιλογές → δημιουργεί snap points ή/και γραμμές-οδηγούς **πάνω στην οντότητα** ή **επεκτεινόμενες** από αυτή.

### 4.5 Εγκεκριμένες Βελτιώσεις — Γύρος 3 (Γιώργος ✅)

| # | Βελτίωση | Περιγραφή | Προτεραιότητα |
|---|----------|-----------|---------------|
| B19 | **Symmetric/Mirror guides** | Άξονας συμμετρίας → οι οδηγοί αντικατοπτρίζονται αυτόματα | Μεσαία |
| B20 | **Guide Undo/Redo** | Ctrl+Z αναιρεί τελευταίο οδηγό, Ctrl+Y επαναφέρει | ⭐ Υψηλή |
| B21 | **Snap priority** | Ρύθμιση προτεραιότητας: τομές > endpoints > midpoints | Χαμηλή |
| B22 | **Right-click context menu** | Δεξί κλικ σε περασιά → Lock, Delete, Color, Properties, Add Points | ⭐ Υψηλή |

### 4.6 Πάρε/Δώσε Παραμέτρους — Property Eyedropper (ΚΕΝΤΡΙΚΟΠΟΙΗΜΕΝΟ)

> Ιδέα Γιώργου, εμπνευσμένη από τον Τέκτονα (εικονίδια "σύριγγας").
> **ΣΗΜΑΝΤΙΚΟ**: Αυτή η λειτουργία θα είναι **γενική κεντρικοποιημένη** σε ολόκληρη την εφαρμογή, ΟΧΙ μόνο στους οδηγούς.

| Εντολή | Εικονίδιο | Workflow |
|--------|-----------|---------|
| **Πάρε Παραμέτρους** | Σύριγγα (αναρρόφηση) | Κλικ σε entity → αντιγράφονται οι ιδιότητές του (χρώμα, πάχος, layer, στυλ...) |
| **Δώσε Παραμέτρους** | Σύριγγα (έγχυση) | Κλικ σε target entity → εφαρμόζονται οι αποθηκευμένες ιδιότητες |

**Πιθανές παράμετροι (TBD — χρειάζεται ξεχωριστό ADR):**
- Χρώμα γραμμής / γέμισμα
- Πάχος γραμμής
- Στυλ γραμμής (solid, dashed, dotted)
- Layer assignment
- Font / μέγεθος κειμένου
- Ιδιότητες οδηγών (αν εφαρμοστεί σε guides)

**→ Θα δημιουργηθεί ξεχωριστό ADR για το Property Eyedropper System**

### 4.7 Εγκεκριμένες Βελτιώσεις — Γύρος 4 (Γιώργος ✅)

| # | Βελτίωση | Περιγραφή | Προτεραιότητα |
|---|----------|-----------|---------------|
| B23 | **Structural presets** | Προκαθορισμένα πλέγματα μηχανικού (ανά 4μ, 5μ, 6μ, 8μ — τυπικά ανοίγματα) | Μεσαία |
| B24 | **Offset from entity edge** | Οδηγός σε ακριβή απόσταση από ακμή οντότητας (π.χ. 10cm από τοίχο) | Μεσαία |
| B25 | **Intersection table** | Πίνακας συντεταγμένων ΟΛΩΝ των σημείων τομής — exportable | Χαμηλή |
| B26 | **Export coordinates** | Εξαγωγή σε CSV/Excel για τοπογράφους/εργοτάξιο | Χαμηλή |
| B27 | **Import coordinates** | Εισαγωγή από τοπογράφο → αυτόματη δημιουργία οδηγών | Χαμηλή |

### 4.8 Περιστροφή Οδηγών (Γιώργος ✅)

> Κρίσιμη λειτουργία — σε πραγματικά projects τα κτίρια σπάνια ευθυγραμμίζονται με τους άξονες X/Y.

| # | Βελτίωση | Περιγραφή | Προτεραιότητα |
|---|----------|-----------|---------------|
| B28 | **Περιστροφή μεμονωμένης περασιάς** | Επιλογή περασιάς → ορισμός κέντρου περιστροφής → γωνία (keyboard ή drag) → real-time preview | ⭐ Υψηλή |
| B29 | **Περιστροφή ομάδας περασιών** | Multi-select πολλαπλών περασιών → κοινή περιστροφή γύρω από σημείο | ⭐ Υψηλή |
| B30 | **Περιστροφή ολόκληρου κάνναβου** | ΟΛΕΣ οι περασιές + snap points περιστρέφονται μαζί — "global grid rotation" | ⭐ Υψηλή |

**Workflow περιστροφής μεμονωμένης (B28):**
1. Επιλογή περασιάς (κλικ)
2. "Ορίστε κέντρο περιστροφής" → κλικ σε σημείο (snap-enabled)
3. **Δύο τρόποι**: (α) πληκτρολόγηση γωνίας + Enter, ή (β) drag με real-time preview
4. Η περασιά περιστρέφεται — η κατακόρυφη γίνεται λοξή κ.λπ.

**Workflow περιστροφής ολόκληρου κάνναβου (B30):**
1. Εντολή "Περιστροφή Κάνναβου"
2. "Ορίστε κέντρο περιστροφής" → κλικ
3. Γωνία (keyboard ή drag) → ΟΛΟΣ ο κάνναβος περιστρέφεται
4. **Use case**: Κτίριο υπό γωνία 15° στο οικόπεδο → grid rotation 15° → οδηγοί ευθυγραμμίζονται με τους τοίχους

### 4.9 Πρόσθετες Ιδέες (προς συζήτηση)

| # | Βελτίωση | Περιγραφή | Προτεραιότητα |
|---|----------|-----------|---------------|
| B31 | **Polar array οδηγών** | Ν οδηγοί σε ίσες γωνίες γύρω από κέντρο (π.χ. 12 ανά 30°) | Μεσαία |
| B32 | **Κλιμάκωση κάνναβου (Scale)** | Αλλαγή κλίμακας ολόκληρου grid — μεγέθυνση/σμίκρυνση | Μεσαία |
| B33 | **Smart equalize** | 3+ παράλληλες → αυτόματη ισαπόσταση | Μεσαία |
| B34 | **Guide constraints** | Παραμετρική σχέση: "πάντα 5μ μεταξύ τους" | Χαμηλή |
| B35 | **Construction line (XLINE)** | Προσωρινή γραμμή — αυτο-διαγράφεται μετά σχεδίαση entity | Μεσαία |
| B36 | **Measure → Guide** | Κατά μέτρηση: "Δημιουργία οδηγού εδώ;" | ⭐ Υψηλή |
| B37 | **Guide from selection** | Πολλά entities → αυτόματοι οδηγοί στις ακμές/κέντρα | Μεσαία |
| B38 | **Custom labels** | Ελεύθερο κείμενο σε οδηγό: "Φέρων τοίχος" | Μεσαία |

### 4.10 Context-Aware Guides — Έξυπνοι Οδηγοί Βάσει Γεωμετρίας (Γιώργος ✅)

> Ιδέα Γιώργου: Οι οδηγοί **καταλαβαίνουν** τη γεωμετρία — δημιουργούνται βάσει υφιστάμενων σχημάτων.

#### B39 — Περιμετρικοί Οδηγοί (Perimeter Offset Guides)

Επιλογή κλειστού σχήματος (π.χ. 4 τοίχοι = δωμάτιο) → δημιουργία οδηγών:

| Επιλογή | Workflow |
|---------|---------|
| **Εξωτερικά περιμετρικά** | Οδηγοί σε **offset εξωτερικά** — απόσταση ορίζεται με πληκτρολόγιο |
| **Εσωτερικά περιμετρικά** | Οδηγοί σε **offset εσωτερικά** — απόσταση ορίζεται με πληκτρολόγιο |
| **Αμφίπλευρα** | Και εξωτερικά και εσωτερικά — διαφορετικές αποστάσεις |

**Use case**: 4 τοίχοι δωματίου → "βάλε κάνναβο 10cm εξωτερικά" → οδηγοί για ακρυλικό/μόνωση.

#### B40 — Υποδιαίρεση Τοίχου (Wall Subdivision Guides)

Κλικ σε ορθογώνιο στοιχείο (τοίχος 25cm × 5.50μ) → **κάθετοι μικροί οδηγοί εντός**:

| Βήμα | Ενέργεια |
|------|----------|
| 1 | Κλικ στον τοίχο (ορθογώνιο) |
| 2 | Popup: "Απόσταση μεταξύ οδηγών" (π.χ. 50cm) ή "Αρχή από:" (κλικ ή αρχή τοίχου) |
| 3 | Δημιουργούνται **μικρές κάθετες γραμμές** ανάμεσα στις 2 μεγάλες παράλληλες πλευρές |
| 4 | Οι μικροί οδηγοί ξεκινούν από το αρχικό σημείο με σταθερό βήμα |

**Use case**: Τοίχος 5.50μ → υποδιαίρεση ανά 50cm → 11 κάθετοι οδηγοί εντός τοίχου → θέσεις σιδηροπλισμού ή θέσεις πλίνθων.

### 4.11 Πρόσθετες Ιδέες (προς συζήτηση)

| # | Βελτίωση | Περιγραφή |
|---|----------|-----------|
| B41 | **Κέντρο δωματίου** | Επιλογή ορίων δωματίου → αυτόματος οδηγός στο **κέντρο βάρους** (centroid) |
| B42 | **Διχοτόμος γωνίας** | 2 τεμνόμενοι οδηγοί → αυτόματος οδηγός στη **διχοτόμο** της γωνίας |
| B43 | **Εφαπτομένη** | Οδηγός εφαπτόμενος σε κύκλο/τόξο σε συγκεκριμένο σημείο |
| B44 | **Extension guide** | Η οντότητα τελειώνει → ο οδηγός **συνεχίζει** στην ίδια κατεύθυνση (άπειρα) |
| B45 | **Grid from boundary** | Επιλογή κλειστού πολυγώνου → γέμισμα με πλέγμα σε ορισμένο spacing |
| B46 | **Parametric grid** | Μεταβλητές: a=5μ, b=3μ → αλλαγή a=6μ → αυτόματη ενημέρωση πλέγματος |
| B47 | **Snap σε κλάσματα** | Snap στο 1/3, 1/4, 1/5 σημείο μεταξύ δύο οδηγών |
| B48 | **Guide heatmap** | Χρωματική ένδειξη πυκνότητας — όπου υπάρχουν πολλοί οδηγοί κοντά → αχνό highlight |

### 4.12 Σύστημα Χρωματικής Απόδοσης Οδηγών (Visual Rendering System)

> Κρίσιμο για τη χρηστικότητα: ο χρήστης πρέπει να **ξεχωρίζει αμέσως** τον τύπο, την ομάδα, και την κατάσταση κάθε οδηγού.

#### Α. Χρωματική Ιεραρχία ανά Τύπο Οδηγού

| Τύπος | Προτεινόμενο Στυλ | Πάχος | Αδιαφάνεια |
|-------|-------------------|-------|------------|
| **Περασιά X/Z** (άπειρες) | Solid, muted χρώμα | 0.5px | 30-40% |
| **Περασιά XZ** (πεπερασμένη) | Dashed `[6, 3]` | 0.5px | 35-45% |
| **Κάθετη** (σε υφιστάμενη) | Dot-dash `[4, 2, 1, 2]` | 0.5px | 30-40% |
| **Παράλληλοι** | Solid, ίδιο χρώμα με parent | 0.5px | 25-35% |
| **Snap points (X)** | Solid X marker | 3-4px | 50-60% |
| **Construction lines** (B35) | Πολύ αχνό, dotted `[2, 4]` | 0.3px | 15-25% |
| **Ακτινικοί** (B9/B31) | Dash `[8, 4]` | 0.5px | 30-40% |

#### Β. Χρωματική Ιεραρχία ανά Ομάδα (Group)

| Ομάδα | Default Χρώμα | Hex | Χρήση |
|-------|---------------|-----|-------|
| **Δομικός Κάνναβος** | Γαλάζιο (Cyan) | `#00BCD4` | Κύρια δομικά στοιχεία |
| **Αρχιτεκτονικός** | Πορτοκαλί (Amber) | `#FFB300` | Αρχιτεκτονικές γραμμές |
| **MEP / Η-Μ** | Πράσινο (Teal) | `#26A69A` | Ηλεκτρομηχανολογικά |
| **Βοηθητικός** | Γκρι (Neutral) | `#9E9E9E` | Πρόχειροι / προσωρινοί |
| **Custom Group** | Επιλογή χρήστη | User color picker | Ελεύθερα |

**Σημαντικό**: Κάθε ομάδα χρησιμοποιεί **τόσο χρώμα ΟΣΟ και dash pattern** → color-blind friendly.

#### Γ. Οπτική Κατάσταση (Visual States)

| Κατάσταση | Εμφάνιση | Πότε |
|-----------|----------|------|
| **Normal** | Βασικό χρώμα + λεπτή | Ανενεργός οδηγός |
| **Hover** | Φωτεινότερο + ελαφρώς παχύτερο (0.5→1px) | Σταυρόνημα κοντά |
| **Selected** | Highlight χρώμα + πάχος 1.5px + glow | Επιλεγμένος |
| **Locked** | Muted + εικονίδιο κλειδαριάς | Κλειδωμένος (B4) |
| **Dragging** | Dynamic preview + dashed | Κατά τη μετακίνηση (B5) |
| **Creating** | Animated dashes (marching ants) | Κατά τη δημιουργία |

#### Δ. Δυναμική Αδιαφάνεια βάσει Zoom

| Zoom Level | Αδιαφάνεια Οδηγών | Λόγος |
|------------|-------------------|-------|
| Πολύ μακριά (< 20%) | 15-20% | Δεν εμποδίζουν τη γενική εικόνα |
| Κανονικό (20-200%) | 30-40% | Ισορροπία ορατότητας |
| Κοντινό (> 200%) | 20-30% | Δεν κρύβουν τις λεπτομέρειες entities |

**Αρχή**: Οι οδηγοί **δεν κυριαρχούν ποτέ** — πάντα δευτερεύοντες οπτικά.

#### Ε. Θέματα (Dark / Light Canvas)

| Canvas | Οδηγοί | Snap Points |
|--------|--------|-------------|
| **Dark background** | Ανοιχτά χρώματα (cyan, pale blue, light green) | Λευκά X/+ markers |
| **Light background** | Σκούρα χρώματα (dark blue, dark green, gray) | Σκούρα X/+ markers |

#### ΣΤ. Νέες Βελτιώσεις Rendering (προς συζήτηση)

| # | Βελτίωση | Περιγραφή |
|---|----------|-----------|
| B49 | **Color theme presets** | Έτοιμα χρωματικά πακέτα: "Structural", "Architecture", "MEP" |
| B50 | **Guide Layer Panel** | Πάνελ σαν Photoshop layers: show/hide/lock/color ανά ομάδα |
| B51 | **Gradient fade** | Οι "άπειρες" περασιές ξεθωριάζουν (fade out) στα άκρα του viewport |
| B52 | **Animated creation** | Κατά τη δημιουργία: "marching ants" animation στη γραμμή |
| B53 | **Dash pattern per type** | Κάθε τύπος οδηγού έχει **μοναδικό** dash pattern (ξεχωρίζει ακόμα χωρίς χρώμα) |
| B54 | **Σταθερό pixel-size** | Οδηγοί πάντα 0.5px ανεξαρτήτως zoom — δεν παχαίνουν/λεπταίνουν |
| B55 | **Print style override** | Κατά εκτύπωση: option να συμπεριληφθούν ως ελαφρύ γκρι dashed |

---

## 7. Ανάλυση Κεντρικοποίησης

> Ποια συστήματα πρέπει να υλοποιηθούν **κεντρικοποιημένα** ώστε να ωφελούν και άλλα σημεία του DXF Viewer.

### 7.1 ΠΡΕΠΕΙ να κεντρικοποιηθούν (ωφελούν πολλά σημεία)

| # | Σύστημα | Ωφελεί | Τρέχουσα κατάσταση |
|---|---------|--------|--------------------|
| C1 | **Guide Rendering Engine** | Οδηγοί, Color Layers, Annotations, Dimensions | Κάθε overlay σχεδιάζει μόνο του — χρειάζεται ενιαίο rendering pipeline |
| C2 | **Property Eyedropper** (§4.6) | ΟΛΕΣ οι οντότητες + οδηγοί + color layers | ΔΕΝ υπάρχει — νέο κεντρικό σύστημα |
| C3 | **Visual State Machine** (hover/select/drag/lock) | Οδηγοί, DXF entities, Color Layer polygons, Grips | Μερικώς υπάρχει (grips) — χρειάζεται γενίκευση |
| C4 | **Layer Management Panel** (B50) | DXF layers, Color Layers, Guide groups | Υπάρχει για DXF + Color Layers — χρειάζεται extension |
| C5 | **Keyboard Shortcut Registry** (B13) | Οδηγοί, Drawing tools, Snap, Zoom, Navigation | Μερικώς υπάρχει — χρειάζεται registry pattern |
| C6 | **Context Menu System** (B22) | Οδηγοί, DXF entities, Color Layers, Canvas | Υπάρχει (EntityContextMenu) — χρειάζεται extension |
| C7 | **Undo/Redo Stack** (B20) | Οδηγοί, Drawing, Entity edits, Color Layers | ΔΕΝ υπάρχει καθολικά — νέο κεντρικό σύστημα |
| C8 | **Snap Integration** (guide snap points) | Ήδη κεντρικοποιημένο (ProSnapEngineV2) | ✅ Υπάρχει — χρειάζεται extension για guide snap type |

### 7.2 ΜΠΟΡΟΥΝ να κεντρικοποιηθούν (προαιρετικά)

| # | Σύστημα | Ωφελεί | Σημείωση |
|---|---------|--------|----------|
| C9 | **Coordinate Import/Export** (B26/B27) | Οδηγοί, DXF entities, Survey data | Μελλοντικό — δεν είναι urgent |
| C10 | **Measurement/Dimension Engine** (B3) | Οδηγοί, Entity dimensions, Area calc | Μερικώς υπάρχει — extensible |
| C11 | **Constraint Engine** (B34) | Οδηγοί, Parametric entities | Πολύ advanced — Phase 3+ |
| C12 | **Multi-select + Batch Operations** (B14) | Οδηγοί, DXF entities, Color Layers | Μερικώς υπάρχει (marquee) — extend |

### 7.3 ΜΕΝΟΥΝ ειδικά του Guide System (δεν κεντρικοποιούνται)

| Σύστημα | Λόγος |
|---------|-------|
| Guide Data Model (περασιές, snap points) | Ειδικό του κάνναβου |
| Guide Toolbar / Menu | Ειδικό UI |
| Περιμετρικοί / Wall subdivision (B39/B40) | Ειδική γεωμετρική λογική |
| Structural presets (B23) | Domain-specific |
| Axis Labels + Bubbles (B1) | Ειδικό rendering |

### 7.4 Σύνοψη Κεντρικοποίησης

```
                    ┌─────────────────────────────┐
                    │   ΚΕΝΤΡΙΚΟΠΟΙΗΜΕΝΑ ΣΥΣΤΗΜΑΤΑ │
                    └──────────┬──────────────────┘
                               │
          ┌────────────────────┼─────────────────────┐
          │                    │                      │
    ┌─────▼──────┐    ┌───────▼────────┐    ┌───────▼────────┐
    │  Rendering │    │  Interaction   │    │    Data        │
    │  Engine    │    │  Engine        │    │    Engine      │
    ├────────────┤    ├────────────────┤    ├────────────────┤
    │ C1 Render  │    │ C3 State Mach. │    │ C7 Undo/Redo  │
    │ C4 Layers  │    │ C5 Shortcuts   │    │ C8 Snap Ext.  │
    │ Colors     │    │ C6 Context Menu│    │ C9 Import/Exp │
    │ Dash patt. │    │ C2 Eyedropper  │    │ C11 Constraints│
    │ Opacity    │    │ C12 Multi-sel. │    │               │
    └─────┬──────┘    └───────┬────────┘    └───────┬────────┘
          │                   │                      │
          └───────────────────┼──────────────────────┘
                              │
          ┌───────────────────┼───────────────────────┐
          │                   │                        │
    ┌─────▼──────┐    ┌──────▼──────┐    ┌────────────▼─┐
    │  GUIDES    │    │  DXF        │    │  COLOR       │
    │  SYSTEM    │    │  ENTITIES   │    │  LAYERS      │
    │  (ADR-189) │    │  (existing) │    │  (existing)  │
    └────────────┘    └─────────────┘    └──────────────┘
```

### 4.13 UI: Floating Panel με Tabs (Γιώργος ✅)

> Με 55+ features, χρειάζεται σωστή οργάνωση UI χωρίς clutter.

**Αρχιτεκτονική 3 επιπέδων** (Figma/Photoshop/Blender pattern):

#### Επίπεδο 1: Floating Panel (κύρια πρόσβαση)
- Εμφανίζεται **μόνο** όταν ενεργοποιείται ο κάνναβος
- Draggable, minimizable, dockable στο πλάι
- Εξαφανίζεται όταν κλείνει ο κάνναβος
- **5 tabs**:
  - **Βασικά**: Περασιά X/Z/XZ, Κάθετη, Παράλληλοι, Αυτόματο Πλέγμα
  - **Σημεία**: Σε Τμήματα, Ανά Απόσταση, Τομές, Προσθήκη/Διαγραφή
  - **Entity**: Από Οντότητα, Περιμετρικοί, Υποδιαίρεση, Extension
  - **Transform**: Μετακίνηση, Περιστροφή, Scale, Mirror, Copy/Offset
  - **⚙ Ρυθμίσεις**: Χρώματα, Groups, Αδιαφάνεια, Dash, Themes

#### Επίπεδο 2: Right-click Context Menu (γρήγορη πρόσβαση)
- Δεξί κλικ σε **οδηγό** → Lock, Delete, Color, Rotate, Properties
- Δεξί κλικ σε **entity** → Οδηγός πάνω στο entity, Snap points κατά μήκος

#### Επίπεδο 3: Keyboard Shortcuts (power users)
- G = Toggle panel, G+X = Περασιά X, G+Z = Περασιά Z
- G+P = Παράλληλοι, G+V = Toggle ορατότητας, Ctrl+Z = Undo

### 4.14 Σχέση με Hatches (Γραμμοσκιάσεις) — Μελλοντική Πρόβλεψη

> Ο Γιώργος ρώτησε: πρέπει να προβλέψουμε τώρα κάτι για hatches (σιδηροπλισμός, πλακάκια);

**Απόφαση**: Guides και Hatches = **ξεχωριστά συστήματα**, αλλά με **κοινή υποδομή**.

| | Κάνναβος (Guides) | Hatches (Γραμμοσκιάσεις) |
|--|-------------------|--------------------------|
| **Σκοπός** | Βοηθητική γεωμετρία — ΔΕΝ αντιπροσωπεύει φυσικό στοιχείο | Αναπαράσταση **πραγματικού** pattern (σιδηροπλισμός, πλακάκια, μπετόν) |
| **Εμφάνιση** | Λεπτές αχνές γραμμές | Pattern fill σε κλειστό boundary |
| **Εκτύπωση** | ❌ ΟΧΙ | ✅ ΝΑΙ — εμφανίζεται στα σχέδια |
| **ADR** | ADR-189 (αυτό) | Ξεχωριστό ADR (μελλοντικό) |

**Κοινή υποδομή που πρέπει να προβλέψουμε ΤΩΡΑ:**

| Shared System | Πώς βοηθάει Guides | Πώς βοηθάει Hatches |
|---------------|--------------------|--------------------|
| **Rendering Engine (C1)** | Σχεδιάζει γραμμές/dash | Σχεδιάζει patterns/fills |
| **Snap Integration (C8)** | Guide snap points | Hatch origin alignment |
| **Subdivision Logic** | "Σε Τμήματα" / "Ανά Απόσταση" | Tile layout spacing |
| **Boundary Detection** | Περιμετρικοί οδηγοί (B39) | Hatch boundary selection |

**Παραδείγματα αλληλεπίδρασης:**
- Σχεδιάζεις πλάκα → βάζεις **οδηγούς** ανά 15cm → μετά εφαρμόζεις **hatch σιδηροπλισμού** πάνω στους οδηγούς
- Σχεδιάζεις δάπεδο → βάζεις **οδηγούς υποδιαίρεσης** → μετά εφαρμόζεις **hatch πλακακιών** 60×60cm
- Ο κάνναβος **βοηθάει** στην τοποθέτηση — το hatch **δείχνει** το αποτέλεσμα

**→ Θα δημιουργηθεί ξεχωριστό ADR για Hatch/Pattern System όταν φτάσουμε εκεί**

### 4.15 Μελλοντική Αλυσίδα: Κάνναβος → Hatches → Smart Layouts

> Ο Γιώργος ρώτησε: θα χρησιμεύει ο κάνναβος για αυτοματισμούς τοποθέτησης (π.χ. είδη υγιεινής σε μπάνιο);
> **Απάντηση: ΝΑΙ** — ο κάνναβος είναι το **θεμέλιο** μιας αλυσίδας 3 επιπέδων.

**Αλυσίδα εξάρτησης:**

| Επίπεδο | Σύστημα | ADR | Κατάσταση |
|---------|---------|-----|-----------|
| 1 | **Κάνναβος** (οδηγοί, snap, subdivision) | ADR-189 | ← ΤΩΡΑ |
| 2 | **Hatches/Patterns** (πλακάκια, σιδηροπλισμός) | TBD | Μελλοντικό |
| 3 | **Smart Layouts** (αυτοματισμοί τοποθέτησης) | TBD | Μελλοντικό |

**Smart Layouts — τι θα χρειαστεί (υψηλό επίπεδο):**
- **Block Library**: Βιβλιοθήκη symbols (νιπτήρας, λεκάνη, ντουζιέρα, μπανιέρα, κρεβάτι, πάγκος κ.λπ.)
- **Placement Rules**: Κανόνες τοποθέτησης (ελάχιστες αποστάσεις, building codes, accessibility)
- **Room Type Recognition**: Αναγνώριση τύπου δωματίου (μπάνιο, κουζίνα, υπνοδωμάτιο)
- **Optimization**: Αλγόριθμος βέλτιστης τοποθέτησης βάσει διαστάσεων δωματίου

**Τι πρέπει να προβλέψουμε ΤΩΡΑ στον κάνναβο:**
- Το **Rendering Engine (C1)** πρέπει να μπορεί να σχεδιάζει blocks/symbols (μελλοντικά)
- Η **υποδιαίρεση χώρου** (B40) πρέπει να επιστρέφει ζώνες (π.χ. "υγρή ζώνη" / "στεγνή ζώνη")
- Οι **περιμετρικοί οδηγοί** (B39) πρέπει να υποστηρίζουν ελάχιστα offsets (building codes)
- Τα **snap points** πρέπει να είναι extensible ώστε blocks να "κουμπώνουν" σε αυτά

---

## 5. Υπάρχουσα Υποδομή στο DXF Viewer μας

| Σύστημα | Κατάσταση | Σχετικότητα |
|---------|-----------|-------------|
| **Grid System** (visual grid) | ✅ Υπάρχει | Βασικός visual grid — ΔΕΝ είναι construction grid |
| **Snap System** (ProSnapEngineV2) | ✅ Υπάρχει | 13 snap types, spatial index, throttled detection |
| **Ruler System** | ✅ Υπάρχει | Rulers στα άκρα — μπορεί να χρησιμοποιηθεί για labels αξόνων |
| **Overlay System** | ✅ Υπάρχει | Μπορεί να φιλοξενήσει grid lines ως ειδικό layer |
| **Level System** | ✅ Υπάρχει | Ανά level/floor — κάνναβος ανά όροφο; |
| **Entity System** | ✅ Υπάρχει | Υποστήριξη line/polyline — grid lines ως entities |

---

## 6. Πηγές

- [LH Λογισμική — Ενεργή οντότητα κάνναβος στο Fespa (Video)](https://www.lhlogismiki.gr/video/fespa-kannavos/)
- [Fespa Manual — Εγχειρίδιο Αναφοράς](https://www.lhlogismiki.gr/book/fespa-manual/)
- [Fespa — Εισαγωγή Δεδομένων](https://www.lhlogismiki.gr/proionta/statika/fespa/skyrodema-eisagogi-dedomenon/)
- [Fespa 4 Manual — DocPlayer (μερικό)](https://docplayer.gr/2296012-Fespa-4-for-windows-to-episiuo-egheiridio-anaforas-a-egheiridio-heirisuoy-athina-septeuvrios-2007.html)
- [Tekton — Σχεδιαστικό Πρόγραμμα](https://www.lhlogismiki.gr/proionta/sxediastika/tekton/)

---

## Changelog

| Ημερομηνία | Αλλαγή |
|-----------|--------|
| 2026-02-19 | Δημιουργία ADR — Αρχικά ευρήματα από web research |
| 2026-02-19 | Πρώτη περιγραφή Γιώργου: Toolbar "Οδηγός", Περασιά X/Z |
| 2026-02-19 | Ανάλυση screenshot Τέκτονα: visual appearance, status bar, snap step |
| 2026-02-19 | Διόρθωση: οι 2 λευκές γραμμές = σταυρόνημα (cursor), ΟΧΙ περασιές. Workflow τοποθέτησης. |
| 2026-02-19 | Πλήρης λίστα 14 εντολών Οδηγού — workflows, τόξα, παράλληλοι, διαγραφές, γενικές ιδιότητες |
| 2026-02-19 | Εγκεκριμένες βελτιώσεις B1-B12 + οπτική διαφοροποίηση + νέες ιδέες B13-B18 |
| 2026-02-19 | B13-B18 εγκρίθηκαν. Νέα ιδέα: αλληλεπίδραση με entities (§4.4) — snap points + guides σε γραμμές/κύκλους/τόξα |
| 2026-02-19 | B19-B22 εγκρίθηκαν. Property Eyedropper (§4.6) — κεντρικοποιημένο σύστημα. Ιδέες B23-B27 |
| 2026-02-19 | B23-B27 εγκρίθηκαν. Περιστροφή οδηγών B28-B30. Νέες ιδέες B31-B38 |
| 2026-02-19 | B31-B38 εγκρίθηκαν. Context-aware guides B39-B40. Ιδέες B41-B48 |
| 2026-02-19 | B41-B48 εγκρίθηκαν. Πλήρες Visual Rendering System (§4.12). Ιδέες B49-B55 |
| 2026-02-19 | B49-B55 εγκρίθηκαν. **Συλλογή απαιτήσεων ΟΛΟΚΛΗΡΩΘΗΚΕ** — 55 features. Ανάλυση κεντρικοποίησης (§7) |
| 2026-02-19 | UI: Floating Panel 3 επιπέδων (§4.13). Hatches vs Guides πρόβλεψη (§4.14) |
