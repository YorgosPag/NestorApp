# ADR-185: AI-Powered DXF Drawing Assistant

> **Status**: ğŸŸ¡ PHASE 1 IMPLEMENTED â€” Basic Drawing Commands
> **Date**: 2026-02-17
> **Category**: AI Architecture / DXF Viewer / CAD Automation
> **Related ADRs**: ADR-171 (Autonomous AI Agent), ADR-080 (AI Pipeline), ADR-031 (Command Pattern), ADR-032 (Drawing State Machine), ADR-057 (Entity Completion Pipeline)
> **Related Documents**:
> - [ADR-186: Building Code Module (ÎÎŸÎš)](./ADR-186-building-code-nok-module.md) â€” Modular ÎºÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ Î´ÏŒÎ¼Î·ÏƒÎ·Ï‚
> - [UC-DXF-AI: Use Cases](./UC-DXF-AI-use-cases.md) â€” Î‘Î½Î±Î»Ï…Ï„Î¹ÎºÎ­Ï‚ Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ Ï‡ÏÎ®ÏƒÎ·Ï‚

---

## 0. Î‘Ï€Î¿Ï†Î¬ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ Î£Ï…Î¶Î®Ï„Î·ÏƒÎ· (2026-02-17)

> Î¤Î± Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î±Ï€Î¿Ï„ÎµÎ»Î¿ÏÎ½ Î±Ï€Î¿Ï†Î¬ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Î»Î®Ï†Î¸Î·ÎºÎ±Î½ ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± ÏƒÏ…Î¶Î®Ï„Î·ÏƒÎ·Ï‚ Î¼ÎµÏ„Î±Î¾Ï Î“Î¹ÏÏÎ³Î¿Ï… Î Î±Î³ÏÎ½Î· ÎºÎ±Î¹ Claude. ÎšÎ¬Î¸Îµ Î±Ï€ÏŒÏ†Î±ÏƒÎ· Î­Ï‡ÎµÎ¹ Î±ÏÎ¹Î¸Î¼ÏŒ (Q-xx) Î³Î¹Î± ÎµÏÎºÎ¿Î»Î· Î±Î½Î±Ï†Î¿ÏÎ¬.

### Q-01: Target Users â€” Î Î¿Î¹Î¿Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î±

| Î¦Î¬ÏƒÎ· | Î§ÏÎ®ÏƒÏ„ÎµÏ‚ |
|------|---------|
| **Î‘ÏÏ‡Î¹ÎºÎ¬** | ÎœÏŒÎ½Î¿ Î¿ Î“Î¹ÏÏÎ³Î¿Ï‚ (admin/Î¼Î·Ï‡Î±Î½Î¹ÎºÏŒÏ‚) |
| **Î‘ÏÎ³ÏŒÏ„ÎµÏÎ±** | + ÎœÎ·Ï‡Î±Î½Î¹ÎºÎ¿Î¯ / Î‘ÏÏ‡Î¹Ï„Î­ÎºÏ„Î¿Î½ÎµÏ‚ |

**Î£Ï…Î½Î­Ï€ÎµÎ¹ÎµÏ‚**: Admin-only access ÏƒÏ„Î·Î½ Î±ÏÏ‡Î®. Î‘ÏÎ³ÏŒÏ„ÎµÏÎ± role-based permissions. Î— AI Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ±Ï„Î±Î½Î¿ÎµÎ¯ Ï„ÎµÏ‡Î½Î¹ÎºÎ® CAD Î¿ÏÎ¿Î»Î¿Î³Î¯Î±.

---

### Q-02: Input Methods â€” Î¤ÏÏŒÏ€Î¿Î¹ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚ ÎµÎ½Ï„Î¿Î»ÏÎ½

| ÎœÎ­Î¸Î¿Î´Î¿Ï‚ | Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· | Î¤ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î± |
|---------|-----------|-----------|
| **Text** (Ï€Î»Î·ÎºÏ„ÏÎ¿Î»ÏŒÎ³Î·ÏƒÎ·) | âœ… ÎÎ±Î¹ | Chat panel input |
| **Voice** (Ï†Ï‰Î½Î®) | âœ… ÎÎ±Î¹ | OpenAI Whisper â†’ text â†’ pipeline |
| **Point + Voice/Text** (Î´ÎµÎ¯Î¾Î¹Î¼Î¿ ÏƒÏ„Î¿Î½ canvas) | âœ… ÎÎ±Î¹ | Click â†’ coordinates â†’ AI context |

**Î£Î—ÎœÎ‘ÎÎ¤Î™ÎšÎŸ**: Multimodal input. ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ»Î¹ÎºÎ¬ÏÎµÎ¹ Î­Î½Î± ÏƒÎ·Î¼ÎµÎ¯Î¿ ÏƒÏ„Î¿Î½ canvas ÎºÎ±Î¹ Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½Î± Î½Î± Î»Î­ÎµÎ¹/Î³ÏÎ¬Ï†ÎµÎ¹ "ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎµ ÎºÏÎºÎ»Î¿ ÎµÎ´Ï". Î— AI Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î¹Ï‚ ÏƒÏ…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½ÎµÏ‚ Ï„Î¿Ï… ÎºÎ»Î¹Îº Ï‰Ï‚ context.

---

### Q-03: UI Position â€” Î˜Î­ÏƒÎ· AI Panel

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Î”ÎµÎ¾Î¯ sidebar** â€” ÏƒÏ„Î±Î¸ÎµÏÏŒ, Ï€Î¬Î½Ï„Î± Î¿ÏÎ±Ï„ÏŒ (consistent Î¼Îµ existing Voice AI panel pattern).

---

### Q-04: Execution Mode â€” Preview Î® Î¬Î¼ÎµÏƒÎ· ÎµÎºÏ„Î­Î»ÎµÏƒÎ·

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Î¥Î²ÏÎ¹Î´Î¹ÎºÏŒ**, Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î·Î½ Ï€Î¿Î»Ï…Ï€Î»Î¿ÎºÏŒÏ„Î·Ï„Î±:

| Î¤ÏÏ€Î¿Ï‚ ÎµÎ½Ï„Î¿Î»Î®Ï‚ | Î£Ï…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ | Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± |
|---------------|------------|-----------|
| **Î‘Ï€Î»Î®** (1-3 entities) | Î†Î¼ÎµÏƒÎ· ÎµÎºÏ„Î­Î»ÎµÏƒÎ· + undo | "Î£Ï‡ÎµÎ´Î¯Î±ÏƒÎµ Î³ÏÎ±Î¼Î¼Î®", "Î£Î²Î®ÏƒÎµ Ï„Î¿Î½ ÎºÏÎºÎ»Î¿" |
| **Î£ÏÎ½Î¸ÎµÏ„Î·** (4+ entities) | Preview (ghost) â†’ Confirm/Cancel | "Î£Ï‡ÎµÎ´Î¯Î±ÏƒÎµ ÎºÎ¬Ï„Î¿ÏˆÎ· 3 Î´Ï‰Î¼Î±Ï„Î¯Ï‰Î½" |

**Î›Î¿Î³Î¹ÎºÎ®**: ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î´ÎµÎ½ ÎµÎ½Î¿Ï‡Î»ÎµÎ¯Ï„Î±Î¹ Î¼Îµ confirmations ÏƒÏ„Î± Î±Ï€Î»Î¬, Î±Î»Î»Î¬ Î´ÎµÎ½ Ï‡Î¬Î½ÎµÎ¹ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ ÏƒÏ„Î± ÏƒÏÎ½Î¸ÎµÏ„Î±. Î— AI Î±Ï€Î¿Ï†Î±ÏƒÎ¯Î¶ÎµÎ¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± Î²Î¬ÏƒÎµÎ¹ Î±ÏÎ¹Î¸Î¼Î¿Ï entities.

---

### Q-05: Î“Î»ÏÏƒÏƒÎ± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±Ï‚

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Î”Î¯Î³Î»Ï‰ÏƒÏƒÎ¿** â€” Î•Î»Î»Î·Î½Î¹ÎºÎ¬ + Î‘Î³Î³Î»Î¹ÎºÎ¬ + Î¼ÎµÎ¹ÎºÏ„Î¬

| Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± | Î“Î»ÏÏƒÏƒÎ± |
|-----------|--------|
| "Î£Ï‡ÎµÎ´Î¯Î±ÏƒÎµ Î¿ÏÎ¸Î¿Î³ÏÎ½Î¹Î¿ 4x3m" | Î•Î»Î»Î·Î½Î¹ÎºÎ¬ |
| "Draw a rectangle 4x3m" | Î‘Î³Î³Î»Î¹ÎºÎ¬ |
| "ÎšÎ¬Î½Îµ offset 2 Î¼Î­Ï„ÏÎ±" | ÎœÎµÎ¹ÎºÏ„Î¬ |

Î— AI Î±Ï€Î±Î½Ï„Î¬ ÏƒÏ„Î· Î³Î»ÏÏƒÏƒÎ± Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·. Î‘Î½Î±Î³Î½Ï‰ÏÎ¯Î¶ÎµÎ¹ CAD terminology ÏƒÎµ ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬ ÎºÎ±Î¹ Î±Î³Î³Î»Î¹ÎºÎ¬.

---

### Q-06: Î¤Î¿Ï€Î¿Î¸Î­Ï„Î·ÏƒÎ· entities â€” Coordinate Awareness

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Context-aware positioning**

| ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· canvas | Î£Ï…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ Ï„Î¿Ï€Î¿Î¸Î­Ï„Î·ÏƒÎ·Ï‚ |
|-----------------|----------------------|
| **ÎšÎµÎ½ÏŒÏ‚ canvas** (Ï„Î¯Ï€Î¿Ï„Î± Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹) | ÎšÎ­Î½Ï„ÏÎ¿ Ï„ÏÎ­Ï‡Î¿Ï…ÏƒÎ±Ï‚ Î¿Î¸ÏŒÎ½Î·Ï‚ |
| **Î¥Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ‡Î­Î´Î¹Î¿** (Ï€.Ï‡. Ï„Î¿Ï€Î¿Î³ÏÎ±Ï†Î¹ÎºÏŒ) | Î£Îµ ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Ï„Î¿ Ï…Ï€Î¬ÏÏ‡Î¿Î½ ÏƒÏ‡Î­Î´Î¹Î¿ |
| **Î§ÏÎ®ÏƒÏ„Î·Ï‚ ÎºÎ»Î¯ÎºÎ±ÏÎµ ÏƒÎ·Î¼ÎµÎ¯Î¿** | Î£Ï„Î¿ ÎºÎ»Î¹ÎºÎ±ÏÎ¹ÏƒÎ¼Î­Î½Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿ |
| **Î§ÏÎ®ÏƒÏ„Î·Ï‚ Î´Î¯Î½ÎµÎ¹ ÏƒÏ…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½ÎµÏ‚** | Î£Ï„Î¹Ï‚ Î´Î¿ÏƒÎ¼Î­Î½ÎµÏ‚ ÏƒÏ…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½ÎµÏ‚ |

**ÎšÎ¡Î™Î£Î™ÎœÎŸ**: Î¤Î± Ï„Î¿Ï€Î¿Î³ÏÎ±Ï†Î¹ÎºÎ¬ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ­Ï‚ ÏƒÏ…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½ÎµÏ‚ (Ï€.Ï‡. Î•Î“Î£Î‘ '87). Î— AI Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏƒÎ­Î²ÎµÏ„Î±Î¹ Î±Ï…Ï„ÏŒ Ï„Î¿ coordinate system â€” Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯ Î±Ï€Î»Î¬ Î½Î± Î²Î¬Î»ÎµÎ¹ ÎºÎ¬Ï„Î¹ ÏƒÏ„Î¿ (0,0) Î±Î½ Ï„Î¿ Î¿Î¹ÎºÏŒÏ€ÎµÎ´Î¿ Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÎµ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ­Ï‚ Î³ÎµÏ‰Î³ÏÎ±Ï†Î¹ÎºÎ­Ï‚ ÏƒÏ…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½ÎµÏ‚.

---

### Q-07: ÎœÎ¿Î½Î¬Î´ÎµÏ‚ Î¼Î­Ï„ÏÎ·ÏƒÎ·Ï‚

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **ÎœÎ­Ï„ÏÎ± (m)** Ï‰Ï‚ default, Î¼Îµ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î· Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î®

| Input Ï‡ÏÎ®ÏƒÏ„Î· | ÎœÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹ ÏƒÎµ |
|-------------|----------------|
| "10 Î¼Î­Ï„ÏÎ±" | 10 m |
| "200 Ï‡Î¹Î»Î¹Î¿ÏƒÏ„Î¬" / "200mm" | 0.2 m |
| "50 ÎµÎºÎ±Ï„Î¿ÏƒÏ„Î¬" / "50cm" | 0.5 m |
| "10" (Ï‡Ï‰ÏÎ¯Ï‚ Î¼Î¿Î½Î¬Î´Î±) | 10 m (default) |

---

### Q-08: Layer Management

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ layer assignment** Î²Î¬ÏƒÎµÎ¹ Ï„ÏÏ€Î¿Ï… entity

Î— AI Î±Î½Î±Î¸Î­Ï„ÎµÎ¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± layer Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¹ ÏƒÏ‡ÎµÎ´Î¹Î¬Î¶ÎµÎ¹:

| Î¤ÏÏ€Î¿Ï‚ ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎ·Ï‚ | Layer |
|-----------------|-------|
| Î¤Î¿Î¯Ï‡Î¿Î¹ | "Î¤Î¿Î¯Ï‡Î¿Î¹" / "Walls" |
| Î ÏŒÏÏ„ÎµÏ‚ | "Î ÏŒÏÏ„ÎµÏ‚" / "Doors" |
| Î Î±ÏÎ¬Î¸Ï…ÏÎ± | "Î Î±ÏÎ¬Î¸Ï…ÏÎ±" / "Windows" |
| ÎˆÏ€Î¹Ï€Î»Î± | "ÎˆÏ€Î¹Ï€Î»Î±" / "Furniture" |
| ÎšÎ¿Î»ÏÎ½ÎµÏ‚ | "Î¦Î­ÏÎ¿Î½" / "Structural" |
| Î“ÎµÏ‰Î¼ÎµÏ„ÏÎ¯Î± (Î³ÎµÎ½Î¹ÎºÎ¬) | "Î“ÎµÏ‰Î¼ÎµÏ„ÏÎ¯Î±" / "Geometry" |
| Î”Î¹Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚ | "Î”Î¹Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚" / "Dimensions" |

> **Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·**: Î¤Î¿ layer mapping Î¸Î± ÎµÎ¯Î½Î±Î¹ configurable. Î‘Ï…Ï„ÏŒÏ‚ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ ÎµÎ¯Î½Î±Î¹ Î±ÏÏ‡Î¹ÎºÏŒ draft â€” Î¸Î± ÏƒÏ…Î¼Ï€Î»Î·ÏÏ‰Î¸ÎµÎ¯.

---

### Q-09: Session Memory

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Session memory Î¼ÏŒÎ½Î¿** (Ï„ÏÎ­Ï‡Î¿Ï…ÏƒÎ± ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±)

| Î¤ÏÏ€Î¿Ï‚ Î¼Î½Î®Î¼Î·Ï‚ | Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· | Î›ÏŒÎ³Î¿Ï‚ |
|-------------|-----------|-------|
| **Session** (ÏƒÎ·Î¼ÎµÏÎ¹Î½Î® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±) | âœ… Î¥Î ÎŸÎ§Î¡Î•Î©Î¤Î™ÎšÎŸ | Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚ ("ÎºÎ¬Î½Îµ Ï„Î¿ Î¯Î´Î¹Î¿", "Î¼ÎµÏ„Î±ÎºÎ¯Î½Î·ÏƒÎµ Î±Ï…Ï„ÏŒ") |
| **Cross-session** (Î±ÏÏÎ¹Î¿) | âŒ ÎŒÏ‡Î¹ Î±ÏÏ‡Î¹ÎºÎ¬ | Î¤Î¿ ÏƒÏ‡Î­Î´Î¹Î¿ ÏƒÏÎ¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ scene â€” Î· AI Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î¿ "Î´ÎµÎ¹" Î¾Î±Î½Î¬. Î‘Î½ Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯, Ï€ÏÎ¿ÏƒÎ¸Î­Ï„Î¿Ï…Î¼Îµ ÎµÏÎºÎ¿Î»Î± Î±ÏÎ³ÏŒÏ„ÎµÏÎ±. |

---

### Q-10: Building Code / ÎÎŸÎš â€” ÎšÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ Î´ÏŒÎ¼Î·ÏƒÎ·Ï‚

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Î‘Î Î‘Î¡Î‘Î™Î¤Î—Î¤ÎŸ ÎµÎ¾Î±ÏÏ‡Î®Ï‚** â€” modular Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ®

**Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î±ÏÏ‡Î­Ï‚:**

1. ÎŸ ÎÎŸÎš **Î”Î•Î** ÎµÎ¯Î½Î±Î¹ hardcoded â€” ÎµÎ¯Î½Î±Î¹ Î­Î½Î± **plugin/module** Ï€Î¿Ï… ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î® Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹
2. ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ ÎµÏ€Î¹Î»Î­Î³ÎµÎ¹: **"Î£Ï‡ÎµÎ´Î¹Î¬Î¶Ï‰ Î¼Îµ ÎºÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒ"** Î® **"Î£Ï‡ÎµÎ´Î¹Î¬Î¶Ï‰ ÎµÎ»ÎµÏÎ¸ÎµÏÎ±"**
3. **Modular ÎºÎ±Î½Î¿Î½Î¹ÏƒÎ¼Î¿Î¯**: ÎÎŸÎš Î•Î»Î»Î¬Î´Î±Ï‚ ÏƒÎ®Î¼ÎµÏÎ±, Î±ÏÏÎ¹Î¿ Î“ÎµÏÎ¼Î±Î½Î¹ÎºÏŒÏ‚, ÎšÏ…Ï€ÏÎ¹Î±ÎºÏŒÏ‚, ÎºÎ»Ï€
4. ÎšÎ¬Î¸Îµ ÎºÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ = **Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„ÏŒ module** (Building Code Provider pattern)

**Î Î·Î³Î­Ï‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½ ÎºÎ±Î½Î¿Î½Î¹ÏƒÎ¼Î¿Ï (Ï€Î¿Î»Î»Î±Ï€Î»Î­Ï‚):**

| Î Î·Î³Î® | Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® |
|------|-----------|
| **Î§ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î±** | ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Î£Î”, ÎºÎ¬Î»Ï…ÏˆÎ·, ÏÏˆÎ¿Ï‚, Î±Ï€Î¿ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚ |
| **Upload Î´Î¹Î±Ï„Î±Î³Î¼Î¬Ï„Ï‰Î½** | Î‘Î½ÎµÎ²Î¬Î¶ÎµÎ¹ PDF/ÏƒÎºÎ±Î½ â†’ AI Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ (Vision API) |
| **Web search** | Î— AI ÏˆÎ¬Ï‡Î½ÎµÎ¹ Î²Î¬ÏƒÎµÎ¹ ÏƒÏ…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½Ï‰Î½/Ï€ÎµÏÎ¹Î¿Ï‡Î®Ï‚ |
| **Override** | "Î›Î¬Î¸Î¿Ï‚ Î£Î”, ÎµÎ¯Î½Î±Î¹ 0.8" â†’ Î· AI Î´Î¹Î¿ÏÎ¸ÏÎ½ÎµÎ¹ |

**Î£Î—ÎœÎ‘ÎÎ¤Î™ÎšÎŸ**: Î— Ï€Î¿Î»ÎµÎ¿Î´Î¿Î¼Î¹ÎºÎ® Î½Î¿Î¼Î¿Î¸ÎµÏƒÎ¯Î± ÏƒÏ„Î·Î½ Î•Î»Î»Î¬Î´Î± ÎµÎ¯Î½Î±Î¹ ÎµÎ¾Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬ Ï€ÎµÏÎ¯Ï€Î»Î¿ÎºÎ· â€” ÎºÎ¬Î¸Îµ Î¿Î¹ÎºÏŒÏ€ÎµÎ´Î¿ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡ÎµÎ¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¿ÏÏ‚ ÏŒÏÎ¿Ï…Ï‚ Î´ÏŒÎ¼Î·ÏƒÎ·Ï‚, ÎµÎ¹Î´Î¹ÎºÎ¬ Î Î”, Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚ Î“Î Î£. Î‘Ï…Ï„ÏŒ Î±Î½Î±Î»ÏÎµÏ„Î±Î¹ ÏƒÎµ Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„ÏŒ **ADR-186**.

---

### Q-11: Î£Ï„Ï…Î» ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎ·Ï‚ Ï„Î¿Î¯Ï‡Ï‰Î½

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **ÎšÎ±Î¹ Ï„Î± Î´ÏÎ¿, ÏƒÏ„Î±Î´Î¹Î±ÎºÎ¬** (Î•Ï€Î¹Î»Î¿Î³Î® Î“)

| Î¦Î¬ÏƒÎ· | Î£Ï„Ï…Î» Ï„Î¿Î¯Ï‡Ï‰Î½ | Î›ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹Î± |
|------|-------------|-------------|
| **Phase 1** | ÎœÎ¿Î½Î® Î³ÏÎ±Î¼Î¼Î® (ÏƒÎºÎ¯Ï„ÏƒÎ¿) | Î”Ï‰Î¼Î¬Ï„Î¹Î¿ = closed polyline (Î¿ÏÎ¸Î¿Î³ÏÎ½Î¹Î¿). Î”Î¿Ï…Î»ÎµÏÎµÎ¹ Î±Î¼Î­ÏƒÏ‰Ï‚ Î¼Îµ existing tools, Î´ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ geometry engine. |
| **Phase 2** | Î”Î¹Ï€Î»Î® Î³ÏÎ±Î¼Î¼Î® Î¼Îµ Ï€Î¬Ï‡Î¿Ï‚ | Î¤Î¿Î¯Ï‡Î¿Ï‚ = wall object Î¼Îµ configurable Ï€Î¬Ï‡Î¿Ï‚ (Ï€.Ï‡. 25cm ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÏŒÏ‚, 10cm ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÏŒÏ‚). Î‘Ï€Î±Î¹Ï„ÎµÎ¯ geometry engine (Section 6.5) Î³Î¹Î± intersections Î³Ï‰Î½Î¹ÏÎ½, T-junctions. |
| **ÎœÎµÏ„Î¬Î²Î±ÏƒÎ·** | "ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î® ÏƒÎµ Ï„ÎµÏ‡Î½Î¹ÎºÏŒ ÏƒÏ‡Î­Î´Î¹Î¿" | Î— AI Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÎ¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± Î¼Î¿Î½Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ ÏƒÎµ Î´Î¹Ï€Î»Î­Ï‚ â€” Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ ÏƒÎºÎ¹Ï„ÏƒÎ¬ÏÎµÎ¹ Î³ÏÎ®Î³Î¿ÏÎ±, Î¼ÎµÏ„Î¬ Î»Î­ÎµÎ¹ "ÎºÎ¬Î½Îµ Ï„Î¿ Ï„ÎµÏ‡Î½Î¹ÎºÏŒ". |

**Î›Î¿Î³Î¹ÎºÎ®**: Î‘ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Ï„Î· Ï†Ï…ÏƒÎ¹ÎºÎ® ÏÎ¿Î® ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚ Î¼Î·Ï‡Î±Î½Î¹ÎºÎ¿Ï â€” Ï€ÏÏÏ„Î± concept (ÏƒÎºÎ¯Ï„ÏƒÎ¿), Î¼ÎµÏ„Î¬ Ï„ÎµÏ‡Î½Î¹ÎºÏŒ ÏƒÏ‡Î­Î´Î¹Î¿.

---

### Q-12: Error Handling AI

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Î— AI ÎµÎ¯Î½Î±Î¹ Î²Î¿Î·Î¸Î·Ï„Î¹ÎºÎ®, Ï€Î¿Ï„Î­ ÎµÎ¼Ï€ÏŒÎ´Î¹Î¿.** 4 ÏƒÎµÎ½Î¬ÏÎ¹Î± Î±Ï€Î¿Ï„Ï…Ï‡Î¯Î±Ï‚:

| Î£ÎµÎ½Î¬ÏÎ¹Î¿ | Î‘Î½Ï„Î¯Î´ÏÎ±ÏƒÎ· ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ |
|---------|---------------------|
| **Timeout** (>60s) | ÎœÎ®Î½Ï…Î¼Î± "Î— ÎµÎ½Ï„Î¿Î»Î® Ï€Î®ÏÎµ Ï€Î¿Î»Ï Ï‡ÏÏŒÎ½Î¿ â€” Î´Î¿ÎºÎ¯Î¼Î±ÏƒÎµ Î¾Î±Î½Î¬ Î® Î±Ï€Î»Î¿Ï€Î¿Î¯Î·ÏƒÎµ" |
| **Î‘ÏƒÎ±Ï†Î®Ï‚ ÎµÎ½Ï„Î¿Î»Î®** | Î— AI ÏÏ‰Ï„Î¬ÎµÎ¹ Ï€Î¯ÏƒÏ‰: "Î¤Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚ Î¸Î­Î»ÎµÎ¹Ï‚; Î“ÏÎ±Î¼Î¼Î®, ÎºÏÎºÎ»Î¿, Î´Ï‰Î¼Î¬Ï„Î¹Î¿;" |
| **Î›Î¬Î¸Î¿Ï‚ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±** | ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î»Î­ÎµÎ¹ "Î‘Î½Î±Î¯ÏÎµÏƒÎµ" â†’ undo Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Ï€Î¬Î½Ï„Î± |
| **API down** (outage) | ÎœÎ®Î½Ï…Î¼Î± "Î— AI Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î·". ÎŸ DXF Viewer Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬ â€” Ï„Î± Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± Î´Î¿Ï…Î»ÎµÏÎ¿Ï…Î½ Ï€Î¬Î½Ï„Î±. |

**Î‘ÏÏ‡Î®**: Î‘Î½ Ï€Î­ÏƒÎµÎ¹ Î· AI, Î´ÎµÎ½ Ï€Î­Ï†Ï„ÎµÎ¹ Î¿ viewer.

---

### Q-12b: AI Learning & Feedback System

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: Î•Î½Î¹Î±Î¯Î¿ feedback system + Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„ÏŒ knowledge base Î±Î½Î¬ Ï„Î¿Î¼Î­Î±.

**Î ÏÏ‚ "Î¼Î±Î¸Î±Î¯Î½ÎµÎ¹" Î· AI** (3 Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼Î¿Î¯):

| ÎœÎ·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒÏ‚ | Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® | Î•Ï†Î±ÏÎ¼Î¿Î³Î® |
|-----------|-----------|----------|
| **System Prompt** | ÎŸÎ´Î·Î³Î¯ÎµÏ‚ Ï€Î¿Ï… Î´Î¯Î½Î¿Ï…Î¼Îµ ÏƒÏ„Î·Î½ AI ÏƒÎµ ÎºÎ¬Î¸Îµ ÎºÎ»Î®ÏƒÎ· | Î‰Î´Î· Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ â€” Î²ÎµÎ»Ï„Î¹ÏÎ½ÎµÏ„Î±Î¹ ÏƒÏ…Î½ÎµÏ‡ÏŒÎ¼ÎµÎ½Î± |
| **Feedback (ğŸ‘/ğŸ‘)** | ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î±Î¾Î¹Î¿Î»Î¿Î³ÎµÎ¯ Ï„Î¹Ï‚ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ AI | Î¥Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ„Î¿ Telegram â€” Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ ÏƒÏ„Î¿ Firestore â†’ Î±Î½Î±Î»ÏÎ¿Ï…Î¼Îµ â†’ Î²ÎµÎ»Ï„Î¹ÏÎ½Î¿Ï…Î¼Îµ prompts |
| **Knowledge Base (RAG)** | Î‘ÏÏ‡ÎµÎ¯Î± Î³Î½ÏÏƒÎ·Ï‚ Ï€Î¿Ï… Î· AI Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï‰Ï‚ context Ï€ÏÎ¹Î½ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹ | ÎÎ­Î¿ â€” Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î¬ Î±ÏÏ‡ÎµÎ¯Î± Î±Î½Î¬ Ï„Î¿Î¼Î­Î± |

**Î£Î—ÎœÎ‘ÎÎ¤Î™ÎšÎŸ**: Î¤Î± LLMs Î´ÎµÎ½ "Î¼Î±Î¸Î±Î¯Î½Î¿Ï…Î½" Î±Ï€ÏŒ Ï„Î· Ï‡ÏÎ®ÏƒÎ·. Î”ÎµÎ½ Î±Î»Î»Î¬Î¶Î¿Ï…Î½. Î— "Î¼Î¬Î¸Î·ÏƒÎ·" Î³Î¯Î½ÎµÏ„Î±Î¹ Î¼Î­ÏƒÏ‰:
- Î’ÎµÎ»Ï„Î¯Ï‰ÏƒÎ· system prompts (Î±Ï€ÏŒ ÎµÎ¼Î¬Ï‚, Î²Î¬ÏƒÎµÎ¹ feedback)
- Î•Î¼Ï€Î»Î¿Ï…Ï„Î¹ÏƒÎ¼ÏŒ knowledge base (Î½Î­Î± Î±ÏÏ‡ÎµÎ¯Î± Î³Î½ÏÏƒÎ·Ï‚)
- Î‘Î½Î¬Î»Ï…ÏƒÎ· feedback patterns (Ï€Î¿Î¹ÎµÏ‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚ Î±Ï€Î¿Ï„Ï…Î³Ï‡Î¬Î½Î¿Ï…Î½ ÏƒÏ…Ï‡Î½Î¬)

**Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ®**:
- **Feedback**: Î•Î½Î¹Î±Î¯Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î³Î¹Î± ÎŸÎ›Î— Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® (Telegram, Email, DXF)
- **Knowledge Base**: ÎÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„ÏŒ Î±Î½Î¬ Ï„Î¿Î¼Î­Î±

**Planned file structure**:
```
src/services/ai-pipeline/knowledge/
â”œâ”€â”€ general/           â€” Î“ÎµÎ½Î¹ÎºÎ® Î³Î½ÏÏƒÎ· ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚
â”œâ”€â”€ dxf-drawing/       â€” CAD tools, entity types, drawing rules
â”œâ”€â”€ building-code/     â€” ÎÎŸÎš, ÎºÎ±Î½Î¿Î½Î¹ÏƒÎ¼Î¿Î¯
â””â”€â”€ feedback/          â€” Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· & Î±Î½Î¬Î»Ï…ÏƒÎ· feedback (ğŸ‘/ğŸ‘ + ÏƒÏ‡ÏŒÎ»Î¹Î±)
```

---

### Q-13: Budget AI â€” Smart Model Routing

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Smart routing** â€” Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î· ÎµÏ€Î¹Î»Î¿Î³Î® Î¼Î¿Î½Ï„Î­Î»Î¿Ï… Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï€Î¿Î»Ï…Ï€Î»Î¿ÎºÏŒÏ„Î·Ï„Î± ÎµÎ½Ï„Î¿Î»Î®Ï‚.

| Î¤ÏÏ€Î¿Ï‚ ÎµÎ½Ï„Î¿Î»Î®Ï‚ | ÎœÎ¿Î½Ï„Î­Î»Î¿ | ÎšÏŒÏƒÏ„Î¿Ï‚/ÎµÎ½Ï„Î¿Î»Î® | Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ |
|---------------|---------|---------------|---------|
| **Î‘Ï€Î»Î®** (Î³ÏÎ±Î¼Î¼Î®, ÎºÏÎºÎ»Î¿Ï‚, Î¿ÏÎ¸Î¿Î³ÏÎ½Î¹Î¿, undo, Î¼Î­Ï„ÏÎ·ÏƒÎ·) | gpt-4o-mini | ~$0.001 | ~80% |
| **Î£ÏÎ½Î¸ÎµÏ„Î·** (Î±Î½Î¬Î»Ï…ÏƒÎ·, ÎºÎ¬Ï„Î¿ÏˆÎ·, vision, building code) | gpt-4o | ~$0.02-0.05 | ~20% |

**Î•ÎºÏ„Î¹Î¼ÏÎ¼ÎµÎ½Î¿ ÎºÏŒÏƒÏ„Î¿Ï‚** (100 ÎµÎ½Ï„Î¿Î»Î­Ï‚/Î·Î¼Î­ÏÎ±): ~$15/Î¼Î®Î½Î±

**Routing logic** (server-side):
- ÎŸ server Î±Ï€Î¿Ï†Î±ÏƒÎ¯Î¶ÎµÎ¹ Î¼Î¿Î½Ï„Î­Î»Î¿ Î²Î¬ÏƒÎµÎ¹: Ï„ÏÏ€Î¿Ï… ÎµÎ½Ï„Î¿Î»Î®Ï‚, ÏÏ€Î±ÏÎ¾Î·Ï‚ ÎµÎ¹ÎºÏŒÎ½Î±Ï‚ (vision), Î±ÏÎ¹Î¸Î¼Î¿Ï entities ÏƒÏ„Î¿ canvas
- ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î´ÎµÎ½ Î²Î»Î­Ï€ÎµÎ¹ / Î´ÎµÎ½ ÎµÏ€Î¹Î»Î­Î³ÎµÎ¹ Î¼Î¿Î½Ï„Î­Î»Î¿ â€” ÎµÎ¯Î½Î±Î¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î¿

---

### Q-14: Multi-level (ÎŒÏÎ¿Ï†Î¿Î¹)

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Î£Ï„Î±Î´Î¹Î±ÎºÎ¬** â€” Phase 1 Ï„ÏÎ­Ï‡Î¿Î½ level Î¼ÏŒÎ½Î¿, Phase 2 level awareness.

| Î¦Î¬ÏƒÎ· | Î£Ï…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ |
|------|-------------|
| **Phase 1** | Î— AI ÏƒÏ‡ÎµÎ´Î¹Î¬Î¶ÎµÎ¹ ÏƒÏ„Î¿ Ï„ÏÎ­Ï‡Î¿Î½ ÎµÎ½ÎµÏÎ³ÏŒ level. ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î±Î»Î»Î¬Î¶ÎµÎ¹ level Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î±. |
| **Phase 2** | Level awareness â€” Î· AI ÎºÎ±Ï„Î±Î»Î±Î²Î±Î¯Î½ÎµÎ¹: "ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎµ ÏƒÏ„Î¿Î½ 2Î¿ ÏŒÏÎ¿Ï†Î¿", "Î±Î½Ï„Î¯Î³ÏÎ±ÏˆÎµ ÎºÎ¬Ï„Î¿ÏˆÎ· ÏƒÎµ Î½Î­Î¿ level", "Ï„Î¹ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ„Î¿ Î¹ÏƒÏŒÎ³ÎµÎ¹Î¿;" |

---

### Q-15: Î‘Î»Î»Î·Î»ÎµÏ€Î¯Î´ÏÎ±ÏƒÎ· Î¼Îµ Imported DXF

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: Î— AI Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÎµÎ¯ **ÎŸÎ›Î‘** Ï„Î± entities (imported + Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¼Î­Î½Î±), Î¼Îµ Î±ÏƒÏ†Î±Î»Î¹ÏƒÏ„Î¹ÎºÎ­Ï‚ Î´Î¹ÎºÎ»ÎµÎ¯Î´ÎµÏ‚.

| ÎšÎ±Î½ÏŒÎ½Î±Ï‚ | Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® |
|---------|-----------|
| **Î Î»Î®ÏÎ·Ï‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·** | Î— AI Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹, Î¼ÎµÏ„Î±ÎºÎ¹Î½Î®ÏƒÎµÎ¹, Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÎ¹ Î¿Ï„Î¹Î´Î®Ï€Î¿Ï„Îµ |
| **Î Î¬Î½Ï„Î± undo-able** | ÎšÎ¬Î¸Îµ ÎµÎ½Î­ÏÎ³ÎµÎ¹Î± Î±Î½Î±Î¹ÏÎµÎ¯Ï„Î±Î¹ (Command Pattern) |
| **Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· ÏƒÎµ bulk** | Î‘Î½ Î· AI Ï€ÏÏŒÎºÎµÎ¹Ï„Î±Î¹ Î½Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ Ï€Î¿Î»Î»Î¬ imported entities â†’ Î¶Î·Ï„Î¬ÎµÎ¹ ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Ï€ÏÏÏ„Î± ("Î˜Î± Î±Î»Î»Î¬Î¾Ï‰ 15 imported entities â€” ÏƒÎ¯Î³Î¿Ï…ÏÎ±;") |

---

### Q-15b: ÎœÎµÎ»Î»Î¿Î½Ï„Î¹ÎºÎ® Î‘Î½ÎµÎ¾Î±ÏÏ„Î·ÏƒÎ¯Î± AI â€” Î”Î¹ÎºÏŒ Î¼Î±Ï‚ ÎœÎ¿Î½Ï„Î­Î»Î¿

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **ÎœÎ•Î›Î›ÎŸÎ¥Î£Î‘ Î•Î¡Î“Î‘Î£Î™Î‘** â€” Î£Ï„Î±Î´Î¹Î±ÎºÎ® Î±Ï€ÎµÎ¾Î¬ÏÏ„Î·ÏƒÎ· Î±Ï€ÏŒ paid AI providers.

**Î£Ï„ÏŒÏ‡Î¿Ï‚**: Î”Î¹ÎºÏŒ Î¼Î±Ï‚ fine-tuned Î¼Î¿Î½Ï„Î­Î»Î¿ ÏƒÎµ Î´Î¹ÎºÏŒ Î¼Î±Ï‚ server, **ÎµÎ»Î¬Ï‡Î¹ÏƒÏ„Î¿ Î® Î¼Î·Î´ÎµÎ½Î¹ÎºÏŒ ÎºÏŒÏƒÏ„Î¿Ï‚ API**.

**Î£Ï„ÏÎ±Ï„Î·Î³Î¹ÎºÎ® 3 Î²Î·Î¼Î¬Ï„Ï‰Î½**:

| Î’Î®Î¼Î± | Î ÏŒÏ„Îµ | Î¤Î¹ ÎºÎ¬Î½Î¿Ï…Î¼Îµ | ÎšÏŒÏƒÏ„Î¿Ï‚ AI |
|------|------|-----------|-----------|
| **1. Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·** | Î¤ÏÏÎ± | OpenAI Î¼Î­ÏƒÏ‰ Vercel AI SDK + Î¼Î±Î¶ÎµÏÎ¿Ï…Î¼Îµ Î´ÎµÎ´Î¿Î¼Î­Î½Î± (ÎµÎ½Ï„Î¿Î»Î­Ï‚, feedback, Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î±) | ~$15/Î¼Î®Î½Î± API |
| **2. Fine-tune open-source** | 6-12 Î¼Î®Î½ÎµÏ‚ | Î•ÎºÏ€Î±Î¹Î´ÎµÏÎ¿Ï…Î¼Îµ Llama/Mistral (MIT, Î´Ï‰ÏÎµÎ¬Î½) Î¼Îµ Ï„Î± Î´Î¹ÎºÎ¬ Î¼Î±Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Î± CAD/Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ®Ï‚ | $200-2000 ÎµÏ†Î¬Ï€Î±Î¾ |
| **3. Self-hosted** | 12-24 Î¼Î®Î½ÎµÏ‚ | Î¤ÏÎ­Ï‡Î¿Ï…Î¼Îµ Î´Î¹ÎºÏŒ Î¼Î±Ï‚ Î¼Î¿Î½Ï„Î­Î»Î¿ ÏƒÎµ Î´Î¹ÎºÏŒ Î¼Î±Ï‚ server (cloud GPU Î® dedicated) | **~â‚¬50-100/Î¼Î®Î½Î± server** (ÎŸÎ§Î™ API fees) |

**Î“Î¹Î±Ï„Î¯ ÎµÎ¯Î½Î±Î¹ ÎµÏ†Î¹ÎºÏ„ÏŒ**:
- Î¤Î± open-source Î¼Î¿Î½Ï„Î­Î»Î± (Llama 4, Mistral) ÎµÎ¯Î½Î±Î¹ **Î´Ï‰ÏÎµÎ¬Î½** (MIT license)
- Î¤Î¿ **Vercel AI SDK** Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Ï„Î¿Ï€Î¹ÎºÎ¬ Î¼Î¿Î½Ï„Î­Î»Î± Î¼Î­ÏƒÏ‰ Ollama â€” Î±Î»Î»Î±Î³Î® = 1 Î³ÏÎ±Î¼Î¼Î® ÎºÏÎ´Î¹ÎºÎ±
- Î¤Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎµÎºÏ€Î±Î¯Î´ÎµÏ…ÏƒÎ·Ï‚ **Ï„Î± Î¼Î±Î¶ÎµÏÎ¿Ï…Î¼Îµ Î—Î”Î—** (feedback, ÎµÎ½Ï„Î¿Î»Î­Ï‚, knowledge base)

**Î¦Î¸Î·Î½ÏŒÏ„ÎµÏÎ·/Î´Ï‰ÏÎµÎ¬Î½ Î»ÏÏƒÎ·**: Self-hosted server Î¼Îµ open-source Î¼Î¿Î½Ï„Î­Î»Î¿ â†’ **Î¼Î·Î´Î­Î½ API fees**, Î¼ÏŒÎ½Î¿ ÎºÏŒÏƒÏ„Î¿Ï‚ server.

**Î ÏÎ¿Ï‹Ï€Î¿Î¸Î­ÏƒÎµÎ¹Ï‚** (Ï„Î± Ï‡Ï„Î¯Î¶Î¿Ï…Î¼Îµ Î¤Î©Î¡Î‘):
- âœ… Vercel AI SDK (provider-agnostic) â€” Î±Ï€Î¿Ï†Î±ÏƒÎ¯ÏƒÏ„Î·ÎºÎµ Q-13 / Section 6.6
- âœ… Feedback collection (ğŸ‘/ğŸ‘) â€” Î±Ï€Î¿Ï†Î±ÏƒÎ¯ÏƒÏ„Î·ÎºÎµ Q-12b
- âœ… Knowledge base (RAG) â€” Î±Ï€Î¿Ï†Î±ÏƒÎ¯ÏƒÏ„Î·ÎºÎµ Q-12b
- â³ Î£Ï…Î»Î»Î¿Î³Î® training data (ÎµÎ½Ï„Î¿Î»Î­Ï‚ Ï‡ÏÎ·ÏƒÏ„ÏÎ½ + ÏƒÏ‰ÏƒÏ„Î­Ï‚ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚)

> **Î£Î—ÎœÎ‘ÎÎ¤Î™ÎšÎŸ**: Î”ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ $100M+ â€” Î±Ï…Ï„ÏŒ ÎºÎ¬Î½Î¿Ï…Î½ Î¼ÏŒÎ½Î¿ Google/Meta/OpenAI. Î•Î¼ÎµÎ¯Ï‚ ÎºÎ¬Î½Î¿Ï…Î¼Îµ **fine-tuning** Ï€Î¬Î½Ï‰ ÏƒÎµ Ï…Ï€Î¬ÏÏ‡Î¿Î½ Î¼Î¿Î½Ï„Î­Î»Î¿, Ï€Î¿Ï… ÎºÎ¿ÏƒÏ„Î¯Î¶ÎµÎ¹ ÎµÎ»Î¬Ï‡Î¹ÏƒÏ„Î±.

---

### Q-16: Canvas State Format â€” Î¤Î¹ "Î²Î»Î­Ï€ÎµÎ¹" Î· AI

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **3 ÎµÏ€Î¯Ï€ÎµÎ´Î± context**, Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ routing Î¼Îµ 3 Î±Ï€Î»Î¿ÏÏ‚ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚ ÏƒÏ„Î¿Î½ server.

| Î•Ï€Î¯Ï€ÎµÎ´Î¿ | Î¤Î¹ ÏƒÏ„Î­Î»Î½ÎµÏ„Î±Î¹ | Î ÏŒÏ„Îµ (ÎºÎ±Î½ÏŒÎ½Î±Ï‚) | Tokens |
|---------|-------------|----------------|--------|
| **Minimal** | Summary: "12 entities (5 Î³ÏÎ±Î¼Î¼Î­Ï‚, 3 Î¿ÏÎ¸Î¿Î³ÏÎ½Î¹Î±...)" | ÎÎ­Î± ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎ·, Î´ÎµÎ½ Î±Î½Î±Ï†Î­ÏÎµÏ„Î±Î¹ ÏƒÎµ Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„Î± | ~100 |
| **Standard** | Summary + Î¿ÏÎ±Ï„Î¬ entities (position, type, dimensions) | Î‘Î½Î±Ï†Î­ÏÎµÏ„Î±Î¹ ÏƒÎµ Ï…Ï€Î¬ÏÏ‡Î¿Î½ ("Î±Ï…Ï„ÏŒ", "Î¼ÎµÏ„Î±ÎºÎ¯Î½Î·ÏƒÎµ", "Ï€Î±ÏÎ¬Î»Î»Î·Î»Î·") | ~500-1000 |
| **Full** | Summary + screenshot (Vision API) | Î–Î·Ï„Î¬ÎµÎ¹ Î¿Ï€Ï„Î¹ÎºÎ® Î±Î½Î¬Î»Ï…ÏƒÎ· ("Ï„Î¹ Î²Î»Î­Ï€ÎµÎ¹Ï‚;", "Î±Î½Î¬Î»Ï…ÏƒÎµ") | ~2000+ |

**Routing**: Deterministic ÎºÏÎ´Î¹ÎºÎ±Ï‚ (3 ÎºÎ±Î½ÏŒÎ½ÎµÏ‚), ÎŸÎ§Î™ Î±Ï€ÏŒÏ†Î±ÏƒÎ· AI. ÎŸ server Î±Ï€Î¿Ï†Î±ÏƒÎ¯Î¶ÎµÎ¹, Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î´ÎµÎ½ Î±ÏƒÏ‡Î¿Î»ÎµÎ¯Ï„Î±Î¹.

**90%+ Ï„Ï‰Î½ ÎµÎ½Ï„Î¿Î»ÏÎ½** Î¸Î± Ï€Î¬ÎµÎ¹ Minimal Î® Standard.

---

### Q-17: Snap Integration

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **ÎŸÎ§Î™ snap** ÏƒÏ„Î± AI-generated points.

| Î¤ÏÏŒÏ€Î¿Ï‚ ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎ·Ï‚ | Snap |
|-------------------|------|
| **Î§ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î±** (Ï€Î¿Î½Ï„Î¯ÎºÎ¹) | âœ… ÎÎ±Î¹ â€” Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î²Î¿Î®Î¸ÎµÎ¹Î± Î±ÎºÏÎ¯Î²ÎµÎ¹Î±Ï‚ |
| **AI-generated** | âŒ ÎŒÏ‡Î¹ â€” Î· AI Î´Î¯Î½ÎµÎ¹ Î±ÎºÏÎ¹Î²ÎµÎ¯Ï‚ ÏƒÏ…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½ÎµÏ‚ server-side Î¼Î­ÏƒÏ‰ geometry engine |

**Î›Î¿Î³Î¹ÎºÎ®**: "ÎŸÏÎ¸Î¿Î³ÏÎ½Î¹Î¿ 4x3m" â†’ Î¿ server Ï…Ï€Î¿Î»Î¿Î³Î¯Î¶ÎµÎ¹ Î±ÎºÏÎ¹Î²ÏÏ‚ 4000mm Ã— 3000mm. Î”ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ snap â€” Ï„Î± Î½Î¿ÏÎ¼ÎµÏÎ± ÎµÎ¯Î½Î±Î¹ Î®Î´Î· ÏƒÏ‰ÏƒÏ„Î¬.

---

### Q-18: Auth & Permissions

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Feature flag Ï„ÏÏÎ±**, role-based Î±ÏÎ³ÏŒÏ„ÎµÏÎ±.

| Î¦Î¬ÏƒÎ· | ÎœÎ·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒÏ‚ | Î ÏÏŒÏƒÎ²Î±ÏƒÎ· |
|------|-----------|----------|
| **Î‘ÏÏ‡Î¹ÎºÎ¬** | Feature flag (on/off ÏƒÏ„Î± settings) | ÎœÏŒÎ½Î¿ Î¿ admin (Î“Î¹ÏÏÎ³Î¿Ï‚) |
| **Î‘ÏÎ³ÏŒÏ„ÎµÏÎ±** | Role-based permissions | Admin + ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½Î¿Î¹ Î¼Î·Ï‡Î±Î½Î¹ÎºÎ¿Î¯ |

---

### Q-19: Offline / Degraded Mode

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Î— AI ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÎ® Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±, ÎŸÎ§Î™ ÎµÎ¾Î¬ÏÏ„Î·ÏƒÎ·.**

Î‘Î½ Ï€Î­ÏƒÎµÎ¹ Ï„Î¿ AI API:
- âœ… Î§ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎ·Ï‚ â†’ Î´Î¿Ï…Î»ÎµÏÎ¿Ï…Î½ Ï€Î¬Î½Ï„Î±
- âœ… Import/Export DXF â†’ Î´Î¿Ï…Î»ÎµÏÎµÎ¹ Ï€Î¬Î½Ï„Î±
- âœ… Layers, levels, undo/redo â†’ Î´Î¿Ï…Î»ÎµÏÎ¿Ï…Î½ Ï€Î¬Î½Ï„Î±
- âš ï¸ AI Chat Panel â†’ "Î— AI Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î· Î±Ï…Ï„Î® Ï„Î· ÏƒÏ„Î¹Î³Î¼Î®"

---

### Q-20: Server Timeout â€” Streaming Responses

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **Streaming** â€” progressive entity-by-entity rendering.

| Î ÏÎ¿ÏƒÎ­Î³Î³Î¹ÏƒÎ· | Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® |
|-----------|-----------|
| ~~Batch (ÎŸÎ›Î‘ Î¼Î±Î¶Î¯)~~ | ~~ÎŸ server Ï„ÎµÎ»ÎµÎ¹ÏÎ½ÎµÎ¹ ÎŸÎ›Î— Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® â†’ ÏƒÏ„Î­Î»Î½ÎµÎ¹ Î¼Î±Î¶Î¯~~ â€” ÎšÎ¯Î½Î´Ï…Î½Î¿Ï‚ timeout, ÎºÎ±ÎºÏŒ UX |
| **Streaming (ÏƒÏ„Î±Î´Î¹Î±ÎºÎ¬)** | ÎšÎ¬Î¸Îµ entity ÏƒÏ„Î­Î»Î½ÎµÏ„Î±Î¹ Î±Î¼Î­ÏƒÏ‰Ï‚ Î¼ÏŒÎ»Î¹Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯ â†’ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ canvas |

**Î Î»ÎµÎ¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î±**:
- ÎšÎ¬Î¸Îµ chunk < 60s â†’ Î´ÎµÎ½ Ï‡Ï„Ï…Ï€Î¬ Vercel timeout
- ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î²Î»Î­Ï€ÎµÎ¹ ÏƒÏ„Î±Î´Î¹Î±ÎºÎ¬ Ï„Î¿ ÏƒÏ‡Î­Î´Î¹Î¿ (progressive rendering)
- ÎœÏ€Î¿ÏÎµÎ¯ Î½Î± Ï€Î±Ï„Î®ÏƒÎµÎ¹ "Cancel" Î±Î½ ÎºÎ¬Ï„Î¹ Ï€Î¬ÎµÎ¹ Î»Î¬Î¸Î¿Ï‚, Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹

---

### Q-21: DXF Export

**Î‘Ï€ÏŒÏ†Î±ÏƒÎ·**: **ÎÎ±Î¹, Î±Î»Î»Î¬ ÎŸÎ§Î™ ÏƒÏ„Î¿ Phase 1.**

| Î¦Î¬ÏƒÎ· | Export |
|------|--------|
| **Phase 1** | ÎŒÏ‡Î¹ â€” ÎµÏƒÏ„Î¹Î¬Î¶Î¿Ï…Î¼Îµ ÏƒÏ„Î· ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎ· Î¼Î­ÏƒÏ‰ AI |
| **Phase 2-3** | ÎÎ±Î¹ â€” export ÏƒÎµ DXF Î±ÏÏ‡ÎµÎ¯Î¿ ÏÏƒÏ„Îµ Î½Î± Î±Î½Î¿Î¯Î¾ÎµÎ¹ ÏƒÎµ AutoCAD/BricsCAD |

**Î›ÏŒÎ³Î¿Ï‚**: Î¤Î¿ DXF export Î±Ï€Î±Î¹Ï„ÎµÎ¯ ÏƒÏ‰ÏƒÏ„Î® Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î® entities ÏƒÎµ DXF format (layers, linetypes, blocks). ÎÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î® ÎµÏÎ³Î±ÏƒÎ¯Î±.

---

## 1. Context & Motivation

### 1.1 Î¤Î¹ Î¶Î·Ï„Î¬Î¼Îµ

Î•Î½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ· Ï„ÎµÏ‡Î½Î·Ï„Î®Ï‚ Î½Î¿Î·Î¼Î¿ÏƒÏÎ½Î·Ï‚ ÏƒÏ„Î¿Î½ DXF Viewer ÏÏƒÏ„Îµ Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î½Î± Î¼Ï€Î¿ÏÎµÎ¯ Î¼Î­ÏƒÏ‰ Ï†Ï…ÏƒÎ¹ÎºÎ®Ï‚ Î³Î»ÏÏƒÏƒÎ±Ï‚ (text Î® Ï†Ï‰Î½Î®) Î½Î±:

- **Î£Ï‡ÎµÎ´Î¹Î¬Î¶ÎµÎ¹** Î³ÎµÏ‰Î¼ÎµÏ„ÏÎ¹ÎºÎ¬ ÏƒÏ‡Î®Î¼Î±Ï„Î± (Î³ÏÎ±Î¼Î¼Î­Ï‚, ÎºÏÎºÎ»Î¿Ï…Ï‚, Î¿ÏÎ¸Î¿Î³ÏÎ½Î¹Î±, Ï€Î¿Î»ÏÎ³Ï‰Î½Î±)
- **Î¤ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÎµÎ¯** Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„Î± ÏƒÏ‡Î­Î´Î¹Î± (Î¼ÎµÏ„Î±ÎºÎ¯Î½Î·ÏƒÎ·, Ï€Î±ÏÎ¬Î»Î»Î·Î»Î·, ÎºÎ¬Î¸ÎµÏ„Î·, ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ·, Î´Î¹Î±Î³ÏÎ±Ï†Î®)
- **ÎœÎµÏ„ÏÎ¬ÎµÎ¹** (Î±Ï€Î¿ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚, ÎµÎ¼Î²Î±Î´Î¬, Î³Ï‰Î½Î¯ÎµÏ‚)
- **Î‘Î½Î±Î»ÏÎµÎ¹** ÏƒÏ‡Î­Î´Î¹Î± (Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· Ï‡ÏÏÏ‰Î½, Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ÎµÎ¼Î²Î±Î´ÏÎ½, Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® Î±Î½Î¬Î»Ï…ÏƒÎ·)
- **Î”Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯** ÏƒÏÎ½Î¸ÎµÏ„Î± Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ¬ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± (Î´Ï‰Î¼Î¬Ï„Î¹Î±, ÎµÏ€Î¹Ï€Î»Ï‰Î¼Î­Î½Î¿Ï…Ï‚ Ï‡ÏÏÎ¿Ï…Ï‚, ÎºÎ±Ï„ÏŒÏˆÎµÎ¹Ï‚)

### 1.2 Î“Î¹Î±Ï„Î¯ Ï„ÏÏÎ±

1. **Î— Ï…Ï€Î¿Î´Î¿Î¼Î® Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î·**: ÎŸ DXF Viewer Î­Ï‡ÎµÎ¹ Ï€Î»Î®ÏÎµÏ‚ programmatic API (20+ ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎ·Ï‚, Command Pattern Î¼Îµ undo/redo, entity builders) ÎºÎ±Î¹ Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î­Ï‡ÎµÎ¹ production-ready agentic AI pipeline (ADR-171)
2. **Î— Î±Î³Î¿ÏÎ¬ ÎºÎ¹Î½ÎµÎ¯Ï„Î±Î¹ ÏÎ±Î³Î´Î±Î¯Î±**: AutoCAD 2026 ÎµÎ½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎµ natural language commands, Ï„Î¿ Zoo (ex-KittyCAD) Ï€ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ production Text-to-CAD API, Y Combinator Ï‡ÏÎ·Î¼Î±Ï„Î¿Î´Î¿Ï„ÎµÎ¯ startups (Adam AI, DraftAid)
3. **Î‘Î½Ï„Î±Î³Ï‰Î½Î¹ÏƒÏ„Î¹ÎºÏŒ Ï€Î»ÎµÎ¿Î½Î­ÎºÏ„Î·Î¼Î±**: Î•Î»Î¬Ï‡Î¹ÏƒÏ„ÎµÏ‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ real estate / construction management ÎµÎ½ÏƒÏ‰Î¼Î±Ï„ÏÎ½Î¿Ï…Î½ AI-powered drawing
4. **Î£Ï„Î±Î´Î¹Î±ÎºÎ® Î¼Î¬Î¸Î·ÏƒÎ·**: Î§Ï„Î¯Î¶Î¿Î½Ï„Î±Ï‚ Ï„ÏÏÎ± Ï„Î· Î²Î¬ÏƒÎ·, ÎºÎ¬Î¸Îµ Î½Î­Î± Î³ÎµÎ½Î¹Î¬ AI Î¼Î¿Î½Ï„Î­Î»Ï‰Î½ (GPT-5, GPT-6) Î¸Î± Î±Î¾Î¹Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± Ï‡Ï‰ÏÎ¯Ï‚ Î±Î»Î»Î±Î³Î­Ï‚ ÎºÏÎ´Î¹ÎºÎ±

### 1.3 State of the Art (ÎˆÏÎµÏ…Î½Î± Î‘Î³Î¿ÏÎ¬Ï‚, Î¦ÎµÎ²ÏÎ¿Ï…Î¬ÏÎ¹Î¿Ï‚ 2026)

| Î ÏÎ¿ÏŠÏŒÎ½/Project | Î¤ÏÏ€Î¿Ï‚ | Î ÏÎ¿ÏƒÎ­Î³Î³Î¹ÏƒÎ· | Status |
|---------------|-------|-----------|--------|
| **AutoCAD 2026** (Autodesk) | Commercial | Natural Language â†’ AutoCAD commands, AI Assistant | Production |
| **Autodesk Forma** | Commercial | Generative site design, environmental analysis | Production |
| **Zoo (ex-KittyCAD)** | Open Source + API | Text-to-CAD, KCL language, MCP Server | Production API |
| **Adam AI** (YC W25) | SaaS | Text-to-3D CAD co-pilot | Early Production |
| **DraftAid** (YC) | SaaS | AI 3D-to-2D fabrication drawings | Production |
| **CAD-MCP** | Open Source | Natural language â†’ AutoLISP â†’ AutoCAD | Experimental |
| **ArchiCAD AI** (Graphisoft) | Commercial | AI chatbot + Stable Diffusion visualizer | Beta |
| **MIT VideoCAD** | Research | AI learns CAD UI from video demonstrations | Research |
| **Text2CAD** | Research (NeurIPS 2024) | End-to-end text â†’ parametric CAD | Research |
| **CAD-GPT** | Research | Spatial reasoning enhanced MLLM | Research |

**Î’Î±ÏƒÎ¹ÎºÎ¬ ÏƒÏ…Î¼Ï€ÎµÏÎ¬ÏƒÎ¼Î±Ï„Î± Î­ÏÎµÏ…Î½Î±Ï‚:**

1. **MCP Protocol** ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÎºÏ…ÏÎ¯Î±ÏÏ‡Î¿ integration pattern AIâ†”CAD (2025-2026)
2. **Code Generation** (AI â†’ domain code â†’ CAD engine) Ï…Ï€ÎµÏÏ„ÎµÏÎµÎ¯ ÏƒÎµ editability vs direct mesh generation
3. **General-purpose LLMs** (GPT-4o, Claude) Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¿ÏÎ½ Ï‰Ï‚ **orchestrators** (tool calling), ÏŒÏ‡Î¹ Ï‰Ï‚ geometric engines
4. **OpenAI Function Calling** + strict mode = reliable tool execution

---

## 2. Î¥Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎ± Î¥Ï€Î¿Î´Î¿Î¼Î® (What We Already Have)

### 2.1 DXF Viewer â€” Drawing System

**Î•ÏÎ³Î±Î»ÎµÎ¯Î± ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎ·Ï‚** (20+):

| ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î± | Î•ÏÎ³Î±Î»ÎµÎ¯Î± |
|-----------|----------|
| **Î’Î±ÏƒÎ¹ÎºÎ¬** | `line`, `rectangle`, `polyline`, `polygon` |
| **ÎšÏÎºÎ»Î¿Î¹** (ADR-083) | `circle`, `circle-diameter`, `circle-2p-diameter`, `circle-3p`, `circle-chord-sagitta`, `circle-2p-radius`, `circle-best-fit` |
| **Î¤ÏŒÎ¾Î±** (ADR-059) | `arc-3p`, `arc-cse`, `arc-sce` |
| **ÎœÎµÏ„ÏÎ®ÏƒÎµÎ¹Ï‚** | `measure-distance`, `measure-distance-continuous`, `measure-area`, `measure-angle` |
| **Î£ÏÎ½Î¸ÎµÏ„Î±** | `useLineParallel`, `useLinePerpendicular`, `useCircleTTT` (tangent-tangent-tangent) |

**Programmatic API:**

```typescript
// Entity creation (pure function, no side effects)
createEntityFromTool(tool: DrawingTool, points: Point2D[], entityId: string, arcFlipped: boolean): ExtendedSceneEntity

// Entity completion (applies styles, adds to scene, tracks for undo)
completeEntity(entity, { tool, levelId, getScene, setScene, trackForUndo }): CompleteEntityResult

// Command Pattern (undo/redo, serializable)
CreateEntityCommand, DeleteEntityCommand, MoveEntityCommand, MoveVertexCommand
```

**Scene Management:**

```typescript
// Scene structure
SceneModel = {
  entities: AnySceneEntity[],
  layers: Record<string, SceneLayer>,
  bounds: { min: Point2D, max: Point2D },
  units: 'mm' | 'cm' | 'm'
}

// Level management
useLevels() â†’ { currentLevelId, getLevelScene, setLevelScene }
```

**Entity Types:**

| Entity | Properties |
|--------|-----------|
| `LineEntity` | start: Point2D, end: Point2D |
| `CircleEntity` | center: Point2D, radius: number |
| `ArcEntity` | center, radius, startAngle, endAngle |
| `PolylineEntity` | vertices: Point2D[], closed?: boolean |
| `RectangleEntity` | corner1: Point2D, corner2: Point2D |
| `TextEntity` | position: Point2D, text: string, fontSize? |
| `PointEntity` | position: Point2D |

**Î’Î±ÏƒÎ¹ÎºÎ¬ Î±ÏÏ‡ÎµÎ¯Î±:**

```
src/subapps/dxf-viewer/
â”œâ”€â”€ hooks/drawing/
â”‚   â”œâ”€â”€ useUnifiedDrawing.tsx          â€” Main drawing API
â”‚   â”œâ”€â”€ drawing-entity-builders.ts     â€” Entity creation (pure)
â”‚   â”œâ”€â”€ completeEntity.ts             â€” Completion pipeline (ADR-057)
â”‚   â”œâ”€â”€ drawing-preview-generator.ts   â€” Preview system
â”‚   â”œâ”€â”€ drawing-types.ts              â€” Type definitions
â”‚   â”œâ”€â”€ useLineParallel.ts            â€” Parallel line
â”‚   â”œâ”€â”€ useLinePerpendicular.ts       â€” Perpendicular line
â”‚   â””â”€â”€ useCircleTTT.ts              â€” Circle tangent-tangent-tangent
â”œâ”€â”€ core/commands/
â”‚   â”œâ”€â”€ interfaces.ts                 â€” ICommand interface
â”‚   â”œâ”€â”€ CommandHistory.ts             â€” Undo/redo stacks
â”‚   â””â”€â”€ entity-commands/              â€” Create, Delete, Move commands
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ entities.ts                   â€” Entity type definitions
â”‚   â””â”€â”€ scene.ts                      â€” Scene types
â””â”€â”€ stores/
    â””â”€â”€ ToolStateStore.ts             â€” Tool state management
```

### 2.2 AI Pipeline â€” Agentic System (ADR-171)

**Î¥Ï€Î¿Î´Î¿Î¼Î® Ï€Î¿Ï… Ï…Ï€Î¬ÏÏ‡ÎµÎ¹:**

| Component | Î‘ÏÏ‡ÎµÎ¯Î¿ | Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± |
|-----------|--------|-----------|
| Agentic Loop | `agentic-loop.ts` | Multi-step reasoning (7 iterations, 50s timeout) |
| Tool Definitions | `agentic-tool-definitions.ts` | 8 tools, OpenAI strict mode JSON Schema |
| Tool Executor | `agentic-tool-executor.ts` | Secure execution engine with whitelisting |
| Pipeline Orchestrator | `pipeline-orchestrator.ts` | Routing + execution + chat history |
| Chat History | `chat-history-service.ts` | 20 messages, 24h TTL |
| Firestore Schema Map | `firestore-schema-map.ts` | 25 collection schemas for AI awareness |

**Existing tools:**
`firestore_query`, `firestore_get_document`, `firestore_count`, `firestore_write`, `send_email_to_contact`, `send_telegram_message`, `get_collection_schema`, `search_text`

**Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÏŒ pattern:**

```
User message â†’ Pipeline Orchestrator â†’ Agentic Loop â†’ OpenAI (tool calling)
                                                      â†•
                                               Tool Executor
                                                      â†“
                                               Final Answer
```

### 2.3 Voice AI (ADR-161, ADR-164)

- **Global Voice Assistant**: Header microphone â†’ OpenAI Whisper â†’ text â†’ AI pipeline
- **In-App Voice AI**: Right-side chat panel â†’ voice/text input â†’ AI response
- **Î”Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„Î±**: Î‰Î´Î· Î¼Ï€Î¿ÏÎµÎ¯ Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î½Î± Î¼Î¹Î»Î®ÏƒÎµÎ¹ â†’ Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î® ÏƒÎµ text â†’ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·

---

## 3. Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® Î‘Ï€ÏŒÏ†Î±ÏƒÎ·

### 3.1 Î•Ï€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿ Pattern: **Agentic Tool Calling (Server-Side)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  DXF Viewer UI                        â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Canvas (Drawing)  â”‚  â”‚  AI Chat Panel         â”‚  â”‚
â”‚  â”‚                     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚   Entities, Grips,  â”‚  â”‚  â”‚ "Î£Ï‡ÎµÎ´Î¯Î±ÏƒÎµ        â”‚   â”‚  â”‚
â”‚  â”‚   Preview, Layers   â”‚  â”‚  â”‚  Î¿ÏÎ¸Î¿Î³ÏÎ½Î¹Î¿ 4x3m" â”‚   â”‚  â”‚
â”‚  â”‚                     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â–²                         â”‚                   â”‚
â”‚           â”‚                         â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              API Route: /api/dxf-ai               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚         DXF Agentic Loop (server)            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  OpenAI GPT-4o â”‚  â”‚ DXF Tool Executor  â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  (tool calling)â”‚â†’â†’â”‚ (validates + plans) â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚        DXF Command Executor (client-side)        â”‚   â”‚
â”‚  â”‚  createEntityFromTool() â†’ completeEntity()       â”‚   â”‚
â”‚  â”‚  CommandHistory (undo/redo)                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Î“Î¹Î±Ï„Î¯ Î±Ï…Ï„ÏŒ Ï„Î¿ pattern

| Î•Î½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÎ® | Î Î»ÎµÎ¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î± | ÎœÎµÎ¹Î¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î± | Î‘Ï€ÏŒÏ†Î±ÏƒÎ· |
|-------------|---------------|---------------|---------|
| **A. Server-side tool calling** | Î‘ÏƒÏ†Î¬Î»ÎµÎ¹Î±, reuse existing pipeline | Client-server roundtrip, latency | **Î•Î Î™Î›Î•Î“ÎœÎ•ÎÎŸ** |
| B. Client-side direct OpenAI | Î§Î±Î¼Î·Î»ÏŒÏ„ÎµÏÎ¿ latency | API key ÏƒÏ„Î¿ client, ÎºÎ¯Î½Î´Ï…Î½Î¿Ï‚ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ | Î‘Ï€Î¿ÏÏÎ¯Ï€Ï„ÎµÏ„Î±Î¹ |
| C. MCP Protocol | Industry standard | Î¥Ï€Î­Ï-Î¼Î·Ï‡Î±Î½Î¹ÎºÎ® Î³Î¹Î± 2D CAD, Î¸Î­Î»ÎµÎ¹ external server | ÎœÎµÎ»Î»Î¿Î½Ï„Î¹ÎºÎ¬ |
| D. Specialized CAD model | ÎšÎ±Î»ÏÏ„ÎµÏÎ¿ geometric reasoning | Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ production-ready Î³Î¹Î± 2D | ÎœÎµÎ»Î»Î¿Î½Ï„Î¹ÎºÎ¬ |

**Î›ÏŒÎ³Î¿Î¹ ÎµÏ€Î¹Î»Î¿Î³Î®Ï‚ Pattern A:**
1. **Reuse**: Î•Ï€Î±Î½Î±Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Ï„Î¿Î½ existing agentic loop (ADR-171) Î¼Îµ Î½Î­Î± tool definitions
2. **Î‘ÏƒÏ†Î¬Î»ÎµÎ¹Î±**: Î¤Î¿ OpenAI API key Î¼Î­Î½ÎµÎ¹ server-side
3. **Auditability**: Server-side logging & audit trail
4. **Undo/Redo**: ÎšÎ¬Î¸Îµ AI action Î³Î¯Î½ÎµÏ„Î±Î¹ Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… Command Pattern â†’ Ï€Î»Î®ÏÎ·Ï‚ undo

### 3.3 Î¡Î¿Î® ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚

```
1. Î§ÏÎ®ÏƒÏ„Î·Ï‚: "Î£Ï‡ÎµÎ´Î¯Î±ÏƒÎµ Î­Î½Î± Î¿ÏÎ¸Î¿Î³ÏÎ½Î¹Î¿ 4x3 Î¼Î­Ï„ÏÎ± ÏƒÏ„Î¿ ÎºÎ­Î½Ï„ÏÎ¿"
2. Client â†’ POST /api/dxf-ai { message, canvasState? }
3. Server: Agentic Loop â†’ OpenAI (tool calling, strict mode)
4. OpenAI decides: call tool "draw_rectangle" { width: 4, height: 3, position: "center" }
5. Server: DXF Tool Executor validates parameters, resolves coordinates
6. Server â†’ Client: { actions: [{ tool: "rectangle", points: [{x:...,y:...}, {x:...,y:...}] }], answer: "Î£Ï‡ÎµÎ´Î¯Î±ÏƒÎ± Î­Î½Î± Î¿ÏÎ¸Î¿Î³ÏÎ½Î¹Î¿ 4Ã—3m..." }
7. Client: Î•ÎºÏ„ÎµÎ»ÎµÎ¯ createEntityFromTool() â†’ completeEntity() â†’ CommandHistory
8. Canvas ÎµÎ½Î·Î¼ÎµÏÏÎ½ÎµÏ„Î±Î¹, entity ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹
```

---

## 4. Î£Ï„Î±Î´Î¹Î±ÎºÎ® Î¥Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ· (Phased Approach)

### Phase 1: Foundation â€” Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î•Î½Ï„Î¿Î»Î­Ï‚ Î£Ï‡ÎµÎ´Î¯Î±ÏƒÎ·Ï‚

**Î£Ï„ÏŒÏ‡Î¿Ï‚**: ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ ÎºÎ±Î¹ Î½Î± Î´Î¹Î±Î³ÏÎ¬Ï†ÎµÎ¹ Î²Î±ÏƒÎ¹ÎºÎ¬ ÏƒÏ‡Î®Î¼Î±Ï„Î± Î¼Î­ÏƒÏ‰ text.

**Scope:**
- Chat panel ÏƒÏ„Î¿Î½ DXF Viewer (sidebar Î® floating)
- API route `/api/dxf-ai`
- DXF-specific tool definitions (JSON Schema, strict mode)
- Client-side command executor

**Tools Phase 1:**

| Tool | Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® | Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± |
|------|-----------|-----------|
| `draw_line` | Î£Ï‡ÎµÎ´Î¹Î¬Î¶ÎµÎ¹ Î³ÏÎ±Î¼Î¼Î® | "Î£Ï‡ÎµÎ´Î¯Î±ÏƒÎµ Î³ÏÎ±Î¼Î¼Î® Î±Ï€ÏŒ (0,0) ÏƒÏ„Î¿ (100,200)" |
| `draw_rectangle` | Î£Ï‡ÎµÎ´Î¹Î¬Î¶ÎµÎ¹ Î¿ÏÎ¸Î¿Î³ÏÎ½Î¹Î¿ | "ÎŸÏÎ¸Î¿Î³ÏÎ½Î¹Î¿ 4x3 Î¼Î­Ï„ÏÎ±" |
| `draw_circle` | Î£Ï‡ÎµÎ´Î¹Î¬Î¶ÎµÎ¹ ÎºÏÎºÎ»Î¿ | "ÎšÏÎºÎ»Î¿Ï‚ Î±ÎºÏ„Î¯Î½Î±Ï‚ 5m ÏƒÏ„Î¿ (50,50)" |
| `draw_polygon` | Î£Ï‡ÎµÎ´Î¹Î¬Î¶ÎµÎ¹ Ï€Î¿Î»ÏÎ³Ï‰Î½Î¿ | "Î¤ÏÎ¯Î³Ï‰Î½Î¿ Î¼Îµ ÎºÎ¿ÏÏ…Ï†Î­Ï‚ (0,0), (10,0), (5,8)" |
| `draw_polyline` | Î£Ï‡ÎµÎ´Î¹Î¬Î¶ÎµÎ¹ Ï€Î¿Î»Ï…Î³ÏÎ±Î¼Î¼Î® | "Î Î¿Î»Ï…Î³ÏÎ±Î¼Î¼Î® Î¼Î­ÏƒÎ± Î±Ï€ÏŒ Ï„Î± ÏƒÎ·Î¼ÎµÎ¯Î±..." |
| `delete_entity` | Î”Î¹Î±Î³ÏÎ¬Ï†ÎµÎ¹ entity | "Î”Î¹Î­Î³ÏÎ±ÏˆÎµ Ï„Î¿Î½ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ ÎºÏÎºÎ»Î¿" |
| `undo_action` | Î‘Î½Î±Î¯ÏÎµÏƒÎ· | "Î‘Î½Î±Î¯ÏÎµÏƒÎµ" |
| `list_entities` | Î›Î¯ÏƒÏ„Î± entities | "Î¤Î¹ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ„Î¿ ÏƒÏ‡Î­Î´Î¹Î¿;" |
| `measure_distance` | ÎœÎ­Ï„ÏÎ·ÏƒÎ· Î±Ï€ÏŒÏƒÏ„Î±ÏƒÎ·Ï‚ | "Î ÏŒÏƒÎ¿ Î±Ï€Î­Ï‡Î¿Ï…Î½ Î±Ï…Ï„Î¬ Ï„Î± Î´ÏÎ¿ ÏƒÎ·Î¼ÎµÎ¯Î±;" |

### Phase 2: Context-Aware â€” Î£Ï‡ÎµÏ„Î¹ÎºÎ­Ï‚ Î•Î½Ï„Î¿Î»Î­Ï‚

**Î£Ï„ÏŒÏ‡Î¿Ï‚**: ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î½Î±Ï†Î­ÏÎµÏ„Î±Î¹ ÏƒÎµ Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„Î± entities ÎºÎ±Î¹ Î½Î± Ï„Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÎµÎ¯.

**Scope:**
- Canvas state awareness (AI "Î²Î»Î­Ï€ÎµÎ¹" Ï„Î± entities)
- Entity selection/reference Î¼Î­ÏƒÏ‰ text
- Î“ÎµÏ‰Î¼ÎµÏ„ÏÎ¹ÎºÎ¿Î¯ Î¼ÎµÏ„Î±ÏƒÏ‡Î·Î¼Î±Ï„Î¹ÏƒÎ¼Î¿Î¯

**Tools Phase 2:**

| Tool | Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® | Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± |
|------|-----------|-----------|
| `query_entities` | Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· entities Î¼Îµ ÎºÏÎ¹Ï„Î®ÏÎ¹Î± | "Î’ÏÎµÏ‚ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚" |
| `move_entity` | ÎœÎµÏ„Î±ÎºÎ¯Î½Î·ÏƒÎ· | "ÎœÎµÏ„Î±ÎºÎ¯Î½Î·ÏƒÎµ Î±Ï…Ï„ÏŒ 5m Î´ÎµÎ¾Î¹Î¬" |
| `copy_entity` | Î‘Î½Ï„Î¹Î³ÏÎ±Ï†Î® | "Î‘Î½Ï„Î¯Î³ÏÎ±ÏˆÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ Î¿ÏÎ¸Î¿Î³ÏÎ½Î¹Î¿" |
| `draw_parallel` | Î Î±ÏÎ¬Î»Î»Î·Î»Î· Î³ÏÎ±Î¼Î¼Î® | "Î Î±ÏÎ¬Î»Î»Î·Î»Î· ÏƒÎµ Î±Ï€ÏŒÏƒÏ„Î±ÏƒÎ· 2m" |
| `draw_perpendicular` | ÎšÎ¬Î¸ÎµÏ„Î· Î³ÏÎ±Î¼Î¼Î® | "ÎšÎ¬Î¸ÎµÏ„Î· ÏƒÎµ Î±Ï…Ï„Î® Ï„Î· Î³ÏÎ±Î¼Î¼Î®" |
| `extend_line` | Î•Ï€Î­ÎºÏ„Î±ÏƒÎ· Î³ÏÎ±Î¼Î¼Î®Ï‚ | "Î•Ï€Î­ÎºÏ„ÎµÎ¹Î½Îµ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Ï„Î¿Î¯Ï‡Î¿" |
| `trim_entity` | Î‘Ï€Î¿ÎºÎ¿Ï€Î® | "ÎšÏŒÏˆÎµ Ï„Î· Î³ÏÎ±Î¼Î¼Î® ÏƒÏ„Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿ Ï„Î¿Î¼Î®Ï‚" |
| `mirror_entity` | ÎšÎ±Ï„Î¿Ï€Ï„ÏÎ¹ÏƒÎ¼ÏŒÏ‚ | "ÎšÎ±Ï„Î¿Ï€Ï„ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï‰Ï‚ Ï€ÏÎ¿Ï‚ Ï„Î¿Î½ Î¬Î¾Î¿Î½Î± Î§" |
| `rotate_entity` | Î ÎµÏÎ¹ÏƒÏ„ÏÎ¿Ï†Î® | "Î ÎµÏÎ¯ÏƒÏ„ÏÎµÏˆÎµ 45 Î¼Î¿Î¯ÏÎµÏ‚" |
| `scale_entity` | ÎšÎ»Î¹Î¼Î¬ÎºÏ‰ÏƒÎ· | "ÎœÎµÎ³Î¬Î»Ï‰ÏƒÎµ 2x" |
| `set_layer` | Î‘Î»Î»Î±Î³Î® layer | "Î’Î¬Î»Îµ ÏƒÎµ layer 'Î¤Î¿Î¯Ï‡Î¿Î¹'" |
| `set_style` | Î‘Î»Î»Î±Î³Î® ÏƒÏ„Ï…Î» | "ÎšÎ¬Î½Îµ Ï„Î· Î³ÏÎ±Î¼Î¼Î® ÎºÏŒÎºÎºÎ¹Î½Î·, Ï€Î¬Ï‡Î¿Ï‚ 2" |

### Phase 3: Vision â€” ÎšÎ±Ï„Î±Î½ÏŒÎ·ÏƒÎ· Î£Ï‡ÎµÎ´Î¯Î¿Ï…

**Î£Ï„ÏŒÏ‡Î¿Ï‚**: Î— AI "Î²Î»Î­Ï€ÎµÎ¹" Ï„Î¿ ÏƒÏ‡Î­Î´Î¹Î¿ (screenshot) ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î¿ Î±Î½Î±Î»ÏÏƒÎµÎ¹.

**Scope:**
- Canvas screenshot â†’ OpenAI Vision API (gpt-4o)
- Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® Î±Î½Î¬Î»Ï…ÏƒÎ·
- Î§Ï‰ÏÎ¹ÎºÎ® Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ·

**Tools Phase 3:**

| Tool | Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® | Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± |
|------|-----------|-----------|
| `analyze_drawing` | Î‘Î½Î¬Î»Ï…ÏƒÎ· ÏƒÏ‡ÎµÎ´Î¯Î¿Ï… (vision) | "Î¤Î¹ Î²Î»Î­Ï€ÎµÎ¹Ï‚ ÏƒÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ‡Î­Î´Î¹Î¿;" |
| `identify_rooms` | Î‘Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· Ï‡ÏÏÏ‰Î½ | "Î ÏŒÏƒÎ± Î´Ï‰Î¼Î¬Ï„Î¹Î± Î­Ï‡ÎµÎ¹;" |
| `calculate_total_area` | Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ÎµÎ¼Î²Î±Î´Î¿Ï | "Î Î¿Î¹Î± Î· ÏƒÏ…Î½Î¿Î»Î¹ÎºÎ® ÎµÏ€Î¹Ï†Î¬Î½ÎµÎ¹Î±;" |
| `suggest_improvements` | Î ÏÎ¿Ï„Î¬ÏƒÎµÎ¹Ï‚ Î²ÎµÎ»Ï„Î¯Ï‰ÏƒÎ·Ï‚ | "Î¤Î¹ Î²ÎµÎ»Ï„Î¹ÏÏƒÎµÎ¹Ï‚ Ï€ÏÎ¿Ï„ÎµÎ¯Î½ÎµÎ¹Ï‚;" |
| `annotate_drawing` | Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î· ÏƒÎ·Î¼ÎµÎ¯Ï‰ÏƒÎ· | "Î’Î¬Î»Îµ labels ÏƒÏ„Î± Î´Ï‰Î¼Î¬Ï„Î¹Î±" |

### Phase 4: Generative â€” Î•Ï…Ï†Ï…Î®Ï‚ Î£Ï‡ÎµÎ´Î¹Î±ÏƒÎ¼ÏŒÏ‚ (ÎœÎ±ÎºÏÎ¿Ï€ÏÏŒÎ¸ÎµÏƒÎ¼Î¿)

**Î£Ï„ÏŒÏ‡Î¿Ï‚**: Î— AI Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ ÏƒÏÎ½Î¸ÎµÏ„Î± Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ¬ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±.

**Scope:**
- Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ¿Î¯ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚ (min/max Î´Î¹Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚, building codes)
- Furniture library
- Template-based generation

**Î ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ Ï‡ÏÎ®ÏƒÎ·Ï‚:**

| Î ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· | Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® | Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± |
|-----------|-----------|-----------|
| Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î´Ï‰Î¼Î±Ï„Î¯Î¿Ï… | Î£Ï‡ÎµÎ´Î¹Î¬Î¶ÎµÎ¹ Ï€Î»Î®ÏÎµÏ‚ Î´Ï‰Î¼Î¬Ï„Î¹Î¿ | "Î£Ï‡ÎµÎ´Î¯Î±ÏƒÎµ Ï…Ï€Î½Î¿Î´Ï‰Î¼Î¬Ï„Î¹Î¿ 4x3m Î¼Îµ Ï€ÏŒÏÏ„Î± ÎºÎ±Î¹ Ï€Î±ÏÎ¬Î¸Ï…ÏÎ¿" |
| Î•Ï€Î¯Ï€Î»Ï‰ÏƒÎ· | Î¤Î¿Ï€Î¿Î¸Î­Ï„Î·ÏƒÎ· ÎµÏ€Î¯Ï€Î»Ï‰Î½ | "Î•Ï€Î¯Ï€Î»Ï‰ÏƒÎµ Ï„Î¿ ÏƒÎ±Î»ÏŒÎ½Î¹" |
| ÎšÎ¬Ï„Î¿ÏˆÎ· | Î Î»Î®ÏÎ·Ï‚ ÎºÎ¬Ï„Î¿ÏˆÎ· | "Î£Ï‡ÎµÎ´Î¯Î±ÏƒÎµ ÎºÎ¬Ï„Î¿ÏˆÎ· Î´Î¹Î±Î¼ÎµÏÎ¯ÏƒÎ¼Î±Ï„Î¿Ï‚ 80Ï„Î¼, 2 Ï…Ï€Î½Î¿Î´Ï‰Î¼Î¬Ï„Î¹Î±" |
| Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î· Î´Î¹Î±ÏƒÏ„Î±ÏƒÎ¹Î¿Î»ÏŒÎ³Î·ÏƒÎ· | Dimensions | "Î’Î¬Î»Îµ Î´Î¹Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚ ÏƒÎµ ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ Ï„Î¿Î¯Ï‡Î¿Ï…Ï‚" |

---

## 5. Î ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ Î§ÏÎ®ÏƒÎ·Ï‚ (Use Cases)

> **Î’Î»Î­Ï€Îµ Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„ÏŒ Î±ÏÏ‡ÎµÎ¯Î¿**: [UC-DXF-AI-use-cases.md](./UC-DXF-AI-use-cases.md)
>
> ÎŸÎ¹ Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ Ï‡ÏÎ®ÏƒÎ·Ï‚ Ï„ÎµÎºÎ¼Î·ÏÎ¹ÏÎ½Î¿Î½Ï„Î±Î¹ ÏƒÎµ Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„ÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Î»ÏŒÎ³Ï‰ Î¼ÎµÎ³Î­Î¸Î¿Ï…Ï‚ ÎºÎ±Î¹ Ï€Î¿Î»Ï…Ï€Î»Î¿ÎºÏŒÏ„Î·Ï„Î±Ï‚.
> Î ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ UC-DXF-001 Î­Ï‰Ï‚ UC-DXF-020+ Î¼Îµ Î±Î½Î±Î»Ï…Ï„Î¹ÎºÎ­Ï‚ ÏÎ¿Î­Ï‚, ÎµÎ½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÎ­Ï‚, ÎºÎ±Î¹ edge cases.

---

## 6. Î¤ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Î‘Ï€Î¿Ï†Î¬ÏƒÎµÎ¹Ï‚

### 6.1 AI Provider

| Î•Ï€Î¹Î»Î¿Î³Î® | Tool Calling | Vision | Î•Î»Î»Î·Î½Î¹ÎºÎ¬ | ÎšÏŒÏƒÏ„Î¿Ï‚ | Î‘Ï€ÏŒÏ†Î±ÏƒÎ· |
|---------|-------------|--------|----------|--------|---------|
| **OpenAI GPT-4o** | Strict mode âœ… | Î•Î¾Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ âœ… | Î Î¿Î»Ï ÎºÎ±Î»Î¬ âœ… | ÎœÎ­Ï„ÏÎ¹Î¿ | **Î•Î Î™Î›Î•Î“ÎœÎ•ÎÎŸ** (Phase 1-3) |
| OpenAI GPT-4o-mini | Strict mode âœ… | ÎšÎ±Î»ÏŒ âœ… | ÎšÎ±Î»Î¬ âœ… | Î§Î±Î¼Î·Î»ÏŒ | Î•Î½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÏŒ (Î±Î½ Î¸Î­Î»Î¿Ï…Î¼Îµ Ï‡Î±Î¼Î·Î»ÏŒ ÎºÏŒÏƒÏ„Î¿Ï‚) |
| Claude 4.5 Sonnet | Tool use âœ… | Î•Î¾Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ âœ… | Î Î¿Î»Ï ÎºÎ±Î»Î¬ âœ… | ÎœÎ­Ï„ÏÎ¹Î¿ | ÎœÎµÎ»Î»Î¿Î½Ï„Î¹ÎºÏŒ |
| Specialized CAD model | Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ âœ… | â€” | â€” | â€” | Phase 4+ |

**Î•Ï€Î¹Î»Î¿Î³Î®**: GPT-4o Î³Î¹Î± tool calling + vision. ÎœÎµÎ»Î»Î¿Î½Ï„Î¹ÎºÎ¬ multi-provider support.

### 6.2 Î“Î»ÏÏƒÏƒÎ± ÎµÎ½Ï„Î¿Î»ÏÎ½

- **Î•Î»Î»Î·Î½Î¹ÎºÎ¬**: Î ÏÏ‰Ï„ÎµÏÎ¿Ï…ÏƒÎ± Î³Î»ÏÏƒÏƒÎ± (Î¿ Î“Î¹ÏÏÎ³Î¿Ï‚ ÎºÎ±Î¹ Î¿Î¹ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ Î¼Î¹Î»Î¿ÏÎ½ ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬)
- **Î‘Î³Î³Î»Î¹ÎºÎ¬**: Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ (GPT-4o Ï„Î± Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÎµÎ¾Î¯ÏƒÎ¿Ï…)
- **System prompt**: Î”Î¯Î³Î»Ï‰ÏƒÏƒÎ¿ (instructions ÏƒÏ„Î± Î±Î³Î³Î»Î¹ÎºÎ¬, Î±Î»Î»Î¬ respond ÏƒÏ„Î· Î³Î»ÏÏƒÏƒÎ± Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·)

### 6.3 Coordinate System

- **ÎœÎ¿Î½Î¬Î´ÎµÏ‚**: ÎœÎ­Ï„ÏÎ± (m) Ï‰Ï‚ default, configurable
- **Origin**: (0,0) = ÎºÎ¬Ï„Ï‰-Î±ÏÎ¹ÏƒÏ„ÎµÏÎ¬ (CAD convention)
- **Î‘Î½Î±Ï†Î¿ÏÎ¬ Î¸Î­ÏƒÎ·Ï‚**: Absolute coordinates Î® relative ("5 Î¼Î­Ï„ÏÎ± Î´ÎµÎ¾Î¹Î¬")
- **Snap**: AI-generated points Ï€ÎµÏÎ½Î¿ÏÎ½ Î¼Î­ÏƒÎ± Î±Ï€ÏŒ snap system

### 6.4 Î‘ÏƒÏ†Î¬Î»ÎµÎ¹Î±

- **Rate limiting**: ÎŠÎ´Î¹Î¿ Î¼Îµ existing API endpoints (ADR-068)
- **Input validation**: AI output validated Ï€ÏÎ¹Î½ ÎµÎºÏ„ÎµÎ»ÎµÏƒÏ„ÎµÎ¯ ÏƒÏ„Î¿ client
- **Undo guarantee**: ÎšÎ¬Î¸Îµ AI action = undo-able command
- **Max entities per request**: Limit (Ï€.Ï‡. 50) Î³Î¹Î± Î±Ï€Î¿Ï†Ï…Î³Î® abuse
- **API key**: Server-side only (Î”Î•Î ÏƒÏ„Î¿ client)

---

### 6.5 Geometry Engine â€” Server-Side Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Î¯ (ÎˆÏÎµÏ…Î½Î± #1, 2026-02-17)

> **Î Î·Î³Î­Ï‚**: ICCV 2025 (CAD-Assistant paper), LLMs for CAD Survey (arxiv:2505.08137)

**ÎšÎ¡Î™Î£Î™ÎœÎŸ Î•Î¥Î¡Î—ÎœÎ‘**: Î¤Î± LLMs Î­Ï‡Î¿Ï…Î½ 42-80% Î±Ï€Î¿Ï„Ï…Ï‡Î¯Î± ÏƒÎµ complex spatial/geometric tasks. **Î ÎŸÎ¤Î•** Î¼Î·Î½ Î±Ï†Î®Î½ÎµÎ¹Ï‚ Ï„Î·Î½ AI Î½Î± Ï…Ï€Î¿Î»Î¿Î³Î¯Î¶ÎµÎ¹ Î³ÎµÏ‰Î¼ÎµÏ„ÏÎ¯Î±. Î— AI Î±Ï€Î¿Ï†Î±ÏƒÎ¯Î¶ÎµÎ¹ **Ï„Î¹** ÏƒÏ‡ÎµÎ´Î¹Î¬Î¶ÎµÏ„Î±Î¹ â€” Î¿ server ÎºÎ¬Î½ÎµÎ¹ Ï„Î¿Ï…Ï‚ Î³ÎµÏ‰Î¼ÎµÏ„ÏÎ¹ÎºÎ¿ÏÏ‚ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿ÏÏ‚ ÏƒÎµ **deterministic code**.

**Î ÏÎ¿Ï„ÎµÎ¹Î½ÏŒÎ¼ÎµÎ½ÎµÏ‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚** (ÏŒÎ»ÎµÏ‚ FREE, permissive licenses):

| Î’Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· | Î†Î´ÎµÎ¹Î± | Î¤Î¹ ÎºÎ¬Î½ÎµÎ¹ | Î§ÏÎ®ÏƒÎ· ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± |
|------------|-------|----------|-------------------|
| **@flatten-js/core** | MIT | Î Î»Î®ÏÎ·Ï‚ 2D geometry (intersections, distances, containment) | **ÎšÎŸÎ¡Î¥Î¦Î‘Î™Î‘ Î•Î Î™Î›ÎŸÎ“Î—** â€” ÎºÎµÎ½Ï„ÏÎ¹ÎºÏŒÏ‚ geometry engine |
| **polyclip-ts** | MIT | Polygon boolean operations (union, difference) | Room detection, walls |
| **clipper2-wasm** | BSL-1.0 | Polygon offset | Î Î¬Ï‡Î¿Ï‚ Ï„Î¿Î¯Ï‡Ï‰Î½ (wall offset/thickness) |
| **rbush** | MIT | Spatial index (R-tree) | Performance â€” "Î²ÏÎµÏ‚ entities ÎºÎ¿Î½Ï„Î¬ ÏƒÎµ ÏƒÎ·Î¼ÎµÎ¯Î¿" |
| **robust-predicates** | ISC | Î‘ÎºÏÎ¯Î²ÎµÎ¹Î± floating-point | Î‘Ï€Î¿Ï†Ï…Î³Î® CAD precision bugs |
| **@turf/turf** | MIT | Geospatial analysis | Î¤Î¿Ï€Î¿Î³ÏÎ±Ï†Î¹ÎºÎ¬, Î•Î“Î£Î‘'87 |

> **Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·**: ÎŒÎ»ÎµÏ‚ Î¿Î¹ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Î­Ï‡Î¿Ï…Î½ **permissive licenses** (MIT/ISC/BSL) â€” Î´ÎµÎ½ Ï…Ï€Î¿Ï‡ÏÎµÏÎ½Î¿Ï…Î½ open-source. Î£Ï…Î¼Î²Î±Ï„Î­Ï‚ Î¼Îµ ADR-034 (License Compliance).

**Planned file structure**:
```
src/services/geometry-engine/
â”œâ”€â”€ geometry-engine.ts              â€” Facade (main API)
â”œâ”€â”€ intersection-solver.ts          â€” Line-line, line-circle, circle-circle
â”œâ”€â”€ offset-calculator.ts            â€” Parallel lines, wall offsets
â”œâ”€â”€ spatial-index.ts                â€” R-tree spatial indexing (rbush)
â”œâ”€â”€ coordinate-transformer.ts       â€” Î•Î“Î£Î‘'87, unit conversions
â””â”€â”€ precision-utils.ts              â€” Robust predicates
```

---

### 6.6 AI Provider Abstraction â€” Î‘Ï€Î¿Ï†Ï…Î³Î® Vendor Lock-in (ÎˆÏÎµÏ…Î½Î± #2, 2026-02-17)

> **Î•ÏÏÏ„Î·ÏƒÎ· Î“Î¹ÏÏÎ³Î¿Ï…**: "Î‘Î½ Î±ÏÏÎ¹Î¿ Î¸Î­Î»Ï‰ Î½Î± Ï†ÏÎ³Ï‰ Î±Ï€ÏŒ OpenAI ÎºÎ±Î¹ Î½Î± Ï€Î¬Ï‰ ÏƒÎµ Anthropic Î® ÎºÎ¬Ï€Î¿Î¹Î¿ Î¬Î»Î»Î¿ ÏƒÏÏƒÏ„Î·Î¼Î±, Î¸Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï€ÏÏŒÎ²Î»Î·Î¼Î±;"
> **Î‘Ï€Î±Î¯Ï„Î·ÏƒÎ·**: ÎœÎ¯Î± Ï€Î»Î·ÏÏ‰Î¼Î® AI provider (ÎŸÎ§Î™ Ï€Î¿Î»Î»Î±Ï€Î»Î¬ APIs), ÎµÎ»ÎµÏ…Î¸ÎµÏÎ¯Î± Î±Î»Î»Î±Î³Î®Ï‚ provider Ï‡Ï‰ÏÎ¯Ï‚ refactoring.

**Î£Ï„ÏÎ±Ï„Î·Î³Î¹ÎºÎ®**: **AI Provider Abstraction Layer** â€” Î­Î½Î± ÎµÎ½Î¹Î±Î¯Î¿ interface, Ï€Î¿Î»Î»Î±Ï€Î»Î¿Î¯ providers Ï€Î¯ÏƒÏ‰.

#### Î‘Î¾Î¹Î¿Î»Î¿Î³Î·Î¼Î­Î½ÎµÏ‚ Î»ÏÏƒÎµÎ¹Ï‚:

| Î›ÏÏƒÎ· | Î†Î´ÎµÎ¹Î± | Î Î»ÎµÎ¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î± | ÎœÎµÎ¹Î¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î± | Î‘Ï€ÏŒÏ†Î±ÏƒÎ· |
|------|-------|---------------|---------------|---------|
| **Vercel AI SDK** | Apache 2.0 | Î‰Î´Î· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Vercel, unified API, streaming, tool calling support, OpenAI/Anthropic/Google/Mistral/Ollama, Next.js native | â€” | **ÎšÎŸÎ¡Î¥Î¦Î‘Î™Î‘ Î•Î Î™Î›ÎŸÎ“Î—** |
| LangChain.js | MIT | ÎœÎµÎ³Î¬Î»Î¿ ecosystem, Ï€Î¿Î»Î»Î¿Î¯ providers | Î’Î±ÏÏ (bundle size), over-engineering Î³Î¹Î± ÎµÎ¼Î¬Ï‚ | Î‘Ï€Î¿ÏÏÎ¯Ï€Ï„ÎµÏ„Î±Î¹ |
| LiteLLM | MIT | 100+ providers, proxy mode | Python only (Î´ÎµÎ½ Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ ÏƒÎµ Next.js) | Î‘Ï€Î¿ÏÏÎ¯Ï€Ï„ÎµÏ„Î±Î¹ |
| OpenRouter | Proprietary | 200+ models, single API key | **Î Î»Î·ÏÏÎ½ÎµÎ¹Ï‚ Ï„ÏÎ¯Ï„Î¿** (middleware fee), vendor lock-in | Î‘Ï€Î¿ÏÏÎ¯Ï€Ï„ÎµÏ„Î±Î¹ |
| Custom abstraction | â€” | Î Î»Î®ÏÎ·Ï‚ Î­Î»ÎµÎ³Ï‡Î¿Ï‚ | Î§ÏÏŒÎ½Î¿Ï‚ Î±Î½Î¬Ï€Ï„Ï…Î¾Î·Ï‚, maintenance | Fallback Î±Î½ Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ |

#### Vercel AI SDK â€” Î“Î¹Î±Ï„Î¯ ÎšÎŸÎ¡Î¥Î¦Î‘Î™Î‘ Î•Î Î™Î›ÎŸÎ“Î—:

1. **Apache 2.0 license** â€” Î´ÎµÎ½ Ï…Ï€Î¿Ï‡ÏÎµÏÎ½ÎµÎ¹ open-source (ADR-034 compliant)
2. **Î‰Î´Î· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Vercel** â€” zero friction integration
3. **Unified API**: Î‘Î»Î»Î±Î³Î® `openai('gpt-4o')` â†’ `anthropic('claude-4.5-sonnet')` = **1 Î³ÏÎ±Î¼Î¼Î® ÎºÏÎ´Î¹ÎºÎ±**
4. **Tool calling support**: Î”Î¿Ï…Î»ÎµÏÎµÎ¹ identically ÏƒÎµ OpenAI, Anthropic, Google
5. **Streaming**: Built-in streaming Î³Î¹Î± progressive rendering
6. **No middleware fees**: Î Î»Î·ÏÏÎ½ÎµÎ¹Ï‚ Î¼ÏŒÎ½Î¿ Ï„Î¿Î½ AI provider, **Î¤Î™Î ÎŸÎ¤Î‘** ÏƒÏ„Î· Vercel Î³Î¹Î± Ï„Î¿ SDK

#### Pattern Î±Î»Î»Î±Î³Î®Ï‚ provider:

```typescript
// Î Î¡Î™Î (OpenAI)
import { openai } from '@ai-sdk/openai';
const model = openai('gpt-4o');

// ÎœÎ•Î¤Î‘ (Anthropic) â€” Î±Î»Î»Î±Î³Î® 1 Î“Î¡Î‘ÎœÎœÎ—Î£
import { anthropic } from '@ai-sdk/anthropic';
const model = anthropic('claude-4.5-sonnet');

// Î¤Î¿ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ ÎŸÎ›ÎŸÎšÎ›Î—Î¡ÎŸ ÏƒÏÏƒÏ„Î·Î¼Î± Î Î‘Î¡Î‘ÎœÎ•ÎÎ•Î™ Î™Î”Î™ÎŸ
const result = await generateText({ model, tools, messages });
```

#### Î’ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÎºÏŒÏƒÏ„Î¿Ï…Ï‚ AI:

| Î£Ï„ÏÎ±Ï„Î·Î³Î¹ÎºÎ® | Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® | Î•Î¾Î¿Î¹ÎºÎ¿Î½ÏŒÎ¼Î·ÏƒÎ· |
|-----------|-----------|-------------|
| **Model routing** | gpt-4o-mini Î³Î¹Î± 80% ÎµÎ½Ï„Î¿Î»ÏÎ½, gpt-4o Î¼ÏŒÎ½Î¿ Î³Î¹Î± vision/complex | ~70% |
| **Prompt caching** | Cached system prompts (OpenAI, Anthropic Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Ï…Î½) | ~50% ÏƒÏ„Î± input tokens |
| **Context pruning** | ÎœÏŒÎ½Î¿ Î¿ÏÎ±Ï„Î¬ entities + summary, ÎŸÎ§Î™ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ canvas state | ~60% |
| **Batched requests** | ÎŸÎ¼Î±Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÏƒÏÎ½Î¸ÎµÏ„Ï‰Î½ ÎµÎ½Ï„Î¿Î»ÏÎ½ | ÎœÎµÎ¯Ï‰ÏƒÎ· roundtrips |

> **Î‘Î ÎŸÎ¦Î‘Î£Î— (ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î¼ÎµÏ„Î¬ C-02)**: Phase 1 = **OpenAI SDK Î¼ÏŒÎ½Î¿**. Î”ÎµÎ½ ÎµÎ¹ÏƒÎ¬Î³Î¿Ï…Î¼Îµ Vercel AI SDK Ï„ÏÏÎ± â€” Î´ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹. Î‘Î½ Î±ÏÎ³ÏŒÏ„ÎµÏÎ± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î±Î»Î»Î±Î³Î® provider, Ï„ÏŒÏ„Îµ ÎµÎ¹ÏƒÎ¬Î³Î¿Ï…Î¼Îµ Vercel AI SDK (Î¼Î¹ÎºÏÎ® Î±Î»Î»Î±Î³Î®). Î— Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® Î¼Î±Ï‚ (server-side tool calling) Î´ÎµÎ½ ÎµÎ¾Î±ÏÏ„Î¬Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ SDK â€” Î· Î¼ÎµÏ„Î¬Î²Î±ÏƒÎ· ÎµÎ¯Î½Î±Î¹ ÎµÏÎºÎ¿Î»Î·.

---

### 6.7 Performance & UX â€” Î ÏÎ¬Î³Î¼Î±Ï„Î± Ï€Î¿Ï… Î¼Î±Ï‚ Î´Î¹Î­Ï†ÎµÏ…Î³Î±Î½ (ÎˆÏÎµÏ…Î½Î± #1, 2026-02-17)

> Î•Ï…ÏÎ®Î¼Î±Ï„Î± Î±Ï€ÏŒ research ÏƒÎµ production AI-CAD systems.

| Î•ÏÏÎ·Î¼Î± | Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® | Î•Î½Î­ÏÎ³ÎµÎ¹Î± |
|--------|-----------|---------|
| **Coordinates ÏƒÎµ mm (integers)** | `{x: 3500, y: 2000}` Î±Î½Ï„Î¯ `{x: 3.5, y: 2.0}`. Î¤Î± integers ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¿ Î±ÎºÏÎ¹Î²Î® ÏƒÏ„Î¿ context ÎµÎ½ÏŒÏ‚ LLM (Î»Î¹Î³ÏŒÏ„ÎµÏÎ± floating-point Î»Î¬Î¸Î·). | Î•ÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ¬ mm integers â†’ display ÏƒÎµ m |
| **Context pruning** | ÎœÎ—Î ÏƒÏ„Î­Î»Î½ÎµÎ¹Ï‚ ÎŸÎ›ÎŸ Ï„Î¿ canvas state ÏƒÏ„Î·Î½ AI. ÎœÏŒÎ½Î¿ Ï„Î± Î¿ÏÎ±Ï„Î¬ entities + summary. | Token budget: max 2000 tokens canvas context |
| **Progressive rendering** | ÎœÎ¹Î± ÏƒÏÎ½Î¸ÎµÏ„Î· ÎµÎ½Ï„Î¿Î»Î® Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î¬ÏÎµÎ¹ 10-30 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±. Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î¼Îµ progress. | Streaming + entity-by-entity rendering |
| **Batched undo** | ÎœÎ¯Î± ÎµÎ½Ï„Î¿Î»Î® AI = Ï€Î¿Î»Î»Î¬ entities (Ï€.Ï‡. 50). Î¤Î¿ undo Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î± Î±Î½Î±Î¹ÏÎµÎ¯ ÎŸÎ›Î‘ Î¼Î±Î¶Î¯. | `CommandGroup` pattern: 1 undo = Î±Î½Î±Î¯ÏÎµÏƒÎ· Ï€Î»Î®ÏÎ¿Ï…Ï‚ AI action |

---

### 6.8 Open Source Reference Projects (ÎˆÏÎµÏ…Î½Î± #1, 2026-02-17)

| Project | Î†Î´ÎµÎ¹Î± | Î¤Î¹ ÎºÎ¬Î½ÎµÎ¹ | Î ÏÏ‚ Î¼Î±Ï‚ Î²Î¿Î·Î¸Î¬ |
|---------|-------|----------|---------------|
| **tldraw "Make Real"** | Apache 2.0 | Canvas â†’ screenshot â†’ GPT-4V â†’ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® | Pattern Î³Î¹Î± vision-based interaction |
| **Zoo/KittyCAD** | MIT | Text-to-CAD, KCL language, MCP Server | UI reference implementation |
| **FloorspaceJS** | BSD | Floor plan editor (NREL) | Floor plan UI/UX reference |

---

## 7. File Structure (Planned)

```
src/
â”œâ”€â”€ app/api/dxf-ai/
â”‚   â””â”€â”€ route.ts                          â€” API endpoint
â”œâ”€â”€ services/dxf-ai/
â”‚   â”œâ”€â”€ dxf-ai-tool-definitions.ts        â€” Tool JSON Schemas
â”‚   â”œâ”€â”€ dxf-ai-tool-executor.ts           â€” Server-side executor
â”‚   â”œâ”€â”€ dxf-ai-system-prompt.ts           â€” System prompt builder
â”‚   â””â”€â”€ dxf-ai-coordinate-resolver.ts     â€” Coordinate logic
â”œâ”€â”€ services/geometry-engine/             â€” Server-side geometry (ÎˆÏÎµÏ…Î½Î± #1)
â”‚   â”œâ”€â”€ geometry-engine.ts                â€” Facade (main API)
â”‚   â”œâ”€â”€ intersection-solver.ts            â€” Line-line, line-circle, circle-circle
â”‚   â”œâ”€â”€ offset-calculator.ts              â€” Parallel lines, wall offsets
â”‚   â”œâ”€â”€ spatial-index.ts                  â€” R-tree spatial indexing (rbush)
â”‚   â”œâ”€â”€ coordinate-transformer.ts         â€” Î•Î“Î£Î‘'87, unit conversions
â”‚   â””â”€â”€ precision-utils.ts                â€” Robust predicates, mm integers
â”œâ”€â”€ subapps/dxf-viewer/
â”‚   â”œâ”€â”€ components/ai-panel/
â”‚   â”‚   â”œâ”€â”€ DxfAiChatPanel.tsx            â€” Chat UI component
â”‚   â”‚   â”œâ”€â”€ DxfAiMessageBubble.tsx        â€” Message display
â”‚   â”‚   â””â”€â”€ DxfAiActionPreview.tsx        â€” Preview Ï€ÏÎ¹Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useDxfAiChat.ts              â€” Chat state management
â”‚   â”‚   â””â”€â”€ useDxfAiExecutor.ts          â€” Client-side command executor
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ dxf-ai-client-executor.ts     â€” ÎœÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÎ¹ AI actions â†’ Commands
```

---

## 8. Î’Î¹Î²Î»Î¹Î¿Î³ÏÎ±Ï†Î¹ÎºÎ­Ï‚ Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

### Î‘ÎºÎ±Î´Î·Î¼Î±ÏŠÎºÎ¬ Papers

1. **Text2CAD** â€” NeurIPS 2024 Spotlight â€” arxiv:2409.17106
2. **CAD-GPT** â€” Spatial Reasoning Enhanced MLLM â€” arxiv:2412.19663
3. **LLMs for Computer-Aided Design: A Survey** â€” arxiv:2505.08137 (ÎœÎ¬Î¹Î¿Ï‚ 2025)
4. **MIT VideoCAD** â€” Learning CAD from Video â€” arxiv:2505.24838 (ÎÎ¿Î­Î¼Î²ÏÎ¹Î¿Ï‚ 2025)
5. **CAD-Llama** â€” LLM for Parametric 3D â€” arxiv:2505.04481

### Commercial & Open Source

6. AutoCAD 2026 AI â€” autodesk.com/blogs/autocad/autocad-2026/
7. Autodesk Forma â€” autodesk.com/products/forma/overview
8. Zoo Text-to-CAD â€” zoo.dev/text-to-cad
9. Zoo KCL Language â€” zoo.dev/research/introducing-kcl
10. Adam AI (YC W25) â€” adam.new
11. DraftAid â€” draftaid.io
12. CAD-MCP (GitHub) â€” github.com/daobataotie/CAD-MCP

### Geometry Libraries (ÎˆÏÎµÏ…Î½Î± #1)

13. @flatten-js/core (MIT) â€” npmjs.com/package/@flatten-js/core
14. polyclip-ts (MIT) â€” npmjs.com/package/polyclip-ts
15. clipper2-wasm (BSL-1.0) â€” npmjs.com/package/clipper2-wasm
16. rbush (MIT) â€” npmjs.com/package/rbush
17. robust-predicates (ISC) â€” npmjs.com/package/robust-predicates
18. @turf/turf (MIT) â€” npmjs.com/package/@turf/turf

### AI Provider Abstraction (ÎˆÏÎµÏ…Î½Î± #2)

19. Vercel AI SDK (Apache 2.0) â€” sdk.vercel.ai
20. tldraw "Make Real" (Apache 2.0) â€” github.com/tldraw/make-real
21. FloorspaceJS (BSD) â€” github.com/NREL/floorspace.js

### Research Papers (ÎˆÏÎµÏ…Î½Î± #1)

22. **ICCV 2025 CAD-Assistant** â€” LLMs as planners, not renderers (42-80% geometric failure rate)
23. **Prompt Engineering for CAD** â€” Coordinates in mm integers, context pruning strategies

---

## 9. Î‘Î½Î¿Î¹Ï‡Ï„Î­Ï‚ Î•ÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚ [Î Î¡ÎŸÎ£ Î£Î¥Î–Î—Î¤Î—Î£Î—]

> Î•Î½Ï„Î¿Ï€Î¯ÏƒÏ„Î·ÎºÎ±Î½ ÎºÎ±Ï„Î¬ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Î³ÏÎ±Î¼Î¼Î®-Î³ÏÎ±Î¼Î¼Î® (2026-02-17). Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±Ï€Î±Î½Ï„Î·Î¸Î¿ÏÎ½ Ï€ÏÎ¹Î½ Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÎ¹ Î· Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ·.

### Î•ÎºÎºÏÎµÎ¼ÎµÎ¯Ï‚ Î‘Ï€Î¿Ï†Î¬ÏƒÎµÎ¹Ï‚ (Q-11+)

| # | Î•ÏÏÏ„Î·ÏƒÎ· | Î‘Î½Î±Ï†Î¿ÏÎ¬ | Status |
|---|---------|---------|--------|
| **Q-11** | **Î£Ï„Ï…Î» ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎ·Ï‚ Ï„Î¿Î¯Ï‡Ï‰Î½**: ÎšÎ±Î¹ Ï„Î± Î´ÏÎ¿ ÏƒÏ„Î±Î´Î¹Î±ÎºÎ¬ â€” Î¼Î¿Î½Î® Î³ÏÎ±Î¼Î¼Î® (Phase 1), Î´Î¹Ï€Î»Î® Î¼Îµ Ï€Î¬Ï‡Î¿Ï‚ (Phase 2), Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î· Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î® | Section 0 â†’ Q-11 | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |
| **Q-12** | **Error handling AI**: 4 ÏƒÎµÎ½Î¬ÏÎ¹Î± â€” timeoutâ†’Î¼Î®Î½Ï…Î¼Î±+retry, Î±ÏƒÎ±Ï†Î®Ï‚â†’AI ÏÏ‰Ï„Î¬ÎµÎ¹ Ï€Î¯ÏƒÏ‰, Î»Î¬Î¸Î¿Ï‚â†’undo, API downâ†’viewer Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬ Ï‡Ï‰ÏÎ¯Ï‚ AI | â€” | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |
| **Q-13** | **Budget AI ÎºÎ»Î®ÏƒÎµÏ‰Î½**: Smart routing â€” Î±Ï€Î»Î­Ï‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚â†’gpt-4o-mini (80%), vision/ÏƒÏÎ½Î¸ÎµÏ„Î±â†’gpt-4o (20%) | Section 6.6 | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |
| **Q-14** | **Multi-level (ÏŒÏÎ¿Ï†Î¿Î¹)**: Phase 1â†’AI ÏƒÏ‡ÎµÎ´Î¹Î¬Î¶ÎµÎ¹ ÏƒÏ„Î¿ Ï„ÏÎ­Ï‡Î¿Î½ level Î¼ÏŒÎ½Î¿. Phase 2â†’level awareness (Î±Î»Î»Î±Î³Î®, Î±Î½Ï„Î¹Î³ÏÎ±Ï†Î® ÎºÎ¬Ï„Î¿ÏˆÎ·Ï‚ ÏƒÎµ Î½Î­Î¿ level). | Section 2.1 | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |
| **Q-15** | **Î‘Î»Î»Î·Î»ÎµÏ€Î¯Î´ÏÎ±ÏƒÎ· Î¼Îµ imported DXF**: AI Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÎµÎ¯ ÎŸÎ›Î‘ (imported + Î´Î¹ÎºÎ¬ Î¼Î±Ï‚), Ï€Î¬Î½Ï„Î± undo-able, ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· ÏƒÎµ bulk Î±Î»Î»Î±Î³Î­Ï‚ imported | UC-DXF-011 | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |
| **Q-16** | **Canvas state format**: 3 ÎµÏ€Î¯Ï€ÎµÎ´Î± (Minimal/Standard/Full), Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ routing Î¼Îµ 3 Î±Ï€Î»Î¿ÏÏ‚ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚ server-side | Section 6.7 | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |
| **Q-17** | **Snap integration**: ÎŸÎ§Î™ snap ÏƒÏ„Î± AI-generated points â€” Î· AI Î´Î¯Î½ÎµÎ¹ Î±ÎºÏÎ¹Î²ÎµÎ¯Ï‚ ÏƒÏ…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½ÎµÏ‚, snap Î¼ÏŒÎ½Î¿ Î³Î¹Î± Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î· ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎ· | Section 6.3 | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |
| **Q-18** | **Auth & permissions**: Feature flag Ï„ÏÏÎ± (admin on/off), role-based Î±ÏÎ³ÏŒÏ„ÎµÏÎ± ÏŒÏ„Î±Î½ Î¼Ï€Î¿Ï…Î½ Î¼Î·Ï‡Î±Î½Î¹ÎºÎ¿Î¯ | Q-01 | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |
| **Q-19** | **Offline/degraded mode**: ÎŸ DXF Viewer Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ 100% ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬ Ï‡Ï‰ÏÎ¯Ï‚ AI â€” Î· AI ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÎ®, ÎŸÎ§Î™ ÎµÎ¾Î¬ÏÏ„Î·ÏƒÎ· | Section 6.6 | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |
| **Q-20** | **Server timeout**: Streaming responses â€” entity-by-entity progressive rendering, ÎºÎ¬Î¸Îµ chunk <60s | Section 6.7 | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |
| **Q-21** | **DXF Export**: ÎÎ±Î¹ Î±Î»Î»Î¬ ÎŸÎ§Î™ Phase 1 â€” export ÏƒÎµ DXF Î±ÏÏ‡ÎµÎ¯Î¿ ÏƒÏ„Î¿ Phase 2-3 | UC-DXF-016 | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |
| **Q-22** | **Layer Architecture**: Î™ÎµÏÎ±ÏÏ‡Î¹ÎºÎ¬ layers Î¼Îµ "/" separator + tree view UI. Naming: "Î¤Î¿Î¯Ï‡Î¿Î¹/Î•Î¾Ï‰Ï„ÎµÏÎ¹ÎºÎ¿Î¯" â†’ parent "Î¤Î¿Î¯Ï‡Î¿Î¹", child "Î•Î¾Ï‰Ï„ÎµÏÎ¹ÎºÎ¿Î¯". Toggle/lock parent â†’ ÎµÏ€Î·ÏÎµÎ¬Î¶ÎµÎ¹ ÏŒÎ»Î± Ï„Î± children. ÎœÎ­Î³Î¹ÏƒÏ„Î¿ Î²Î¬Î¸Î¿Ï‚ 2 ÎµÏ€Î¯Ï€ÎµÎ´Î±. Default layers ÏƒÎµ ÎºÎ¬Î¸Îµ Î½Î­Î¿ project. Î— AI Ï„Î¿Ï€Î¿Î¸ÎµÏ„ÎµÎ¯ entities ÏƒÏ„Î¿ ÏƒÏ‰ÏƒÏ„ÏŒ layer Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î±. ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ ÎµÎ»ÎµÏÎ¸ÎµÏÎ± Î´Î¹ÎºÎ¬ Ï„Î¿Ï… layers. | Q-08, ADR-186 #4 | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |
| **Q-23** | **Real-time Constraint Monitoring**: Î— AI Î´ÎµÎ½ Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ ÎºÎ¬Î¸Îµ ÎºÎ¯Î½Î·ÏƒÎ· (Î±ÎºÏÎ¹Î²ÏŒ). Î‘Î½Ï„' Î±Ï…Ï„Î¿Ï: Î•Ï€Î¯Ï€ÎµÎ´Î¿ 1 (Phase 2) = Î¿ Geometry Engine ÎµÎ»Î­Î³Ï‡ÎµÎ¹ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚ ÎÎŸÎš Ï„Î¿Ï€Î¹ÎºÎ¬ ÏƒÎµ ÎºÎ¬Î¸Îµ drop (Î´Ï‰ÏÎµÎ¬Î½, <10ms) â€” Ï€.Ï‡. "Î¿ Ï„Î¿Î¯Ï‡Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î± 2.1m, ÎµÎ»Î¬Ï‡Î¹ÏƒÏ„Î· Î´=2.5m". Î•Ï€Î¯Ï€ÎµÎ´Î¿ 2 (Phase 3+) = Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ ÏÏ‰Ï„Î¬ÎµÎ¹ AI Î³Î¹Î± ÏƒÏÎ½Î¸ÎµÏ„Î· ÏƒÏ…Î¼Î²Î¿Ï…Î»Î® ("Ï„Î¹ Ï€ÏÎ¿Ï„ÎµÎ¯Î½ÎµÎ¹Ï‚;"). ÎŸ Geometry Engine ÎºÎ¬Î½ÎµÎ¹ Î¼Î±Î¸Î·Î¼Î±Ï„Î¹ÎºÎ¬, Î· AI Î¼Ï€Î±Î¯Î½ÎµÎ¹ Î¼ÏŒÎ½Î¿ Î³Î¹Î± ÎµÏÎ¼Î·Î½ÎµÎ¯ÎµÏ‚. | ADR-186, Q-09 | âœ… Î‘Î Î‘ÎÎ¤Î—Î˜Î—ÎšÎ• |

### Î‘Î½Ï„Î¹Ï†Î¬ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î¬Î¶Î¿Ï…Î½ Î´Î¹ÎµÏ…ÎºÏÎ¯Î½Î¹ÏƒÎ·

| # | Î‘Î½Ï„Î¯Ï†Î±ÏƒÎ· | Î Î¿Ï Î²ÏÎ­Î¸Î·ÎºÎµ | Î ÏÏŒÏ„Î±ÏƒÎ· |
|---|----------|------------|---------|
| **C-01** | **ÎœÎ¿Î½Î¬Î´ÎµÏ‚: m vs mm** â€” 3 ÏƒÏ„ÏÏÎ¼Î±Ï„Î±: Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¼Î¹Î»Î¬ÎµÎ¹ ÏƒÎµ m, AI ÎµÏ€ÎµÎ¾ÎµÏÎ³Î¬Î¶ÎµÏ„Î±Î¹ ÏƒÎµ mm integers, canvas ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ ÏƒÎµ m. Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î· Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î®, Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î´ÎµÎ½ Î²Î»Î­Ï€ÎµÎ¹ Ï€Î¿Ï„Î­ mm. | Q-07 vs 6.7 | âœ… Î›Î¥Î˜Î—ÎšÎ• |
| **C-02** | **Vercel AI SDK**: ÎŸÎ§Î™ Ï„ÏÏÎ±. Phase 1 = OpenAI SDK Î¼ÏŒÎ½Î¿. Vercel AI SDK ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Î±Î¹ Î±ÏÎ³ÏŒÏ„ÎµÏÎ± ÎœÎŸÎÎŸ Î±Î½ Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î±Î»Î»Î±Î³Î® provider. | Section 6.6 vs ADR-171 | âœ… Î›Î¥Î˜Î—ÎšÎ• |

---

## 9b. Phase 1 Implementation Details (2026-02-17)

### Status: âœ… IMPLEMENTED â€” 9 new files, 4 modified, 0 TS errors

### Architecture Implemented

```
User types â†’ useDxfAiChat hook â†’ POST /api/dxf-ai/command
                                       â†“
                             OpenAI gpt-4o-mini + 5 DXF tools
                                       â†“
                             Structured tool_calls response
                                       â†“
             executeDxfAiToolCalls() â†’ completeEntities() â†’ Canvas
```

**Key decisions vs plan:**
- **Single-call** (NOT agentic loop) â€” Phase 1 doesn't need multi-step reasoning
- **Client-side executor** â€” tool calls validated + executed on client via `completeEntities()` (ADR-057)
- **Feature flag gated** â€” `NEXT_PUBLIC_DXF_AI_ASSISTANT=true` required to enable

### Files Implemented

| File | Type | Description |
|------|------|-------------|
| `src/subapps/dxf-viewer/ai-assistant/types.ts` | NEW | Full type system (messages, tools, API payloads, execution results) |
| `src/subapps/dxf-viewer/config/ai-assistant-config.ts` | NEW | Centralized constants (DXF_AI_UNITS, DXF_AI_LIMITS, DXF_AI_API, DXF_AI_DEFAULTS) |
| `src/subapps/dxf-viewer/config/feature-flags.ts` | MOD | Added `USE_AI_DRAWING_ASSISTANT` feature flag |
| `src/subapps/dxf-viewer/ai-assistant/dxf-tool-definitions.ts` | NEW | 5 OpenAI tools with strict JSON Schema |
| `src/subapps/dxf-viewer/ai-assistant/dxf-system-prompt.ts` | NEW | Context-aware system prompt builder |
| `src/app/api/dxf-ai/command/route.ts` | NEW | API route (withAuth + withStandardRateLimit + maxDuration=60) |
| `src/subapps/dxf-viewer/ai-assistant/dxf-ai-tool-executor.ts` | NEW | Client-side tool executor â†’ validates + creates entities |
| `src/subapps/dxf-viewer/ai-assistant/hooks/useDxfAiChat.ts` | NEW | React hook: state, API, execution pipeline |
| `src/subapps/dxf-viewer/ai-assistant/components/DxfAiChatPanel.tsx` | NEW | Chat panel UI (semantic HTML, Tailwind only) |
| `src/subapps/dxf-viewer/ai-assistant/index.ts` | NEW | Barrel exports |
| `src/i18n/locales/{el,en}/dxf-viewer.json` | MOD | Added `aiAssistant.*` translations |
| `src/subapps/dxf-viewer/app/DxfViewerContent.tsx` | MOD | Integrated lazy-loaded chat panel behind feature flag |

### Tools Implemented (Phase 1)

| Tool | Arguments | Validation |
|------|-----------|------------|
| `draw_line` | start_x, start_y, end_x, end_y, layer?, color? | Rejects zero-length lines |
| `draw_rectangle` | x, y, width, height, layer?, color? | Rejects non-positive dimensions |
| `draw_circle` | center_x, center_y, radius, layer?, color? | Rejects non-positive radius |
| `query_entities` | type?, layer? | Read-only, returns entity summary |
| `undo_action` | count? | Placeholder â€” Phase 1b integration |

### Reused Centralized Systems

| System | From | Used For |
|--------|------|----------|
| `completeEntities()` | ADR-057 | Batch entity insertion with event emission |
| `generateEntityId()` | enterprise-id.service | Crypto-secure entity IDs |
| `DXF_DEFAULT_LAYER` | layer-config.ts | Default layer '0' |
| `UI_COLORS.WHITE` | color-config.ts | Default entity color |
| `withAuth` | @/lib/auth | API authentication |
| `withStandardRateLimit` | @/lib/middleware | Rate limiting |
| `AI_ANALYSIS_DEFAULTS` | ai-analysis-config.ts | OpenAI model + base URL |
| `AgenticToolDefinition` | agentic-tool-definitions.ts | Tool definition type reuse |
| `useSemanticColors` | design-system/color-bridge | Theme-aware styling |
| `useTranslation` | i18n/hooks | Internationalization |

### Activation

1. Set `NEXT_PUBLIC_DXF_AI_ASSISTANT=true` in `.env.local`
2. Ensure `OPENAI_API_KEY` is set (server-side)
3. Open DXF Viewer â†’ trigger action `toggle-ai-assistant`
4. Type: "ÏƒÏ‡ÎµÎ´Î¯Î±ÏƒÎµ Î³ÏÎ±Î¼Î¼Î® Î±Ï€ÏŒ 0,0 Î¼Î­Ï‡ÏÎ¹ 10,5" â†’ line appears on canvas

---

## 10. Changelog

| Date | Change | By |
|------|--------|-----|
| 2026-02-17 | Initial draft â€” Architecture, 4 phases, market research | Claude + Î“Î¹ÏÏÎ³Î¿Ï‚ |
| 2026-02-17 | Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· 11 Î±Ï€Î¿Ï†Î¬ÏƒÎµÏ‰Î½ (Q-01 â†’ Q-11) Î±Ï€ÏŒ ÏƒÏ…Î¶Î®Ï„Î·ÏƒÎ· | Claude + Î“Î¹ÏÏÎ³Î¿Ï‚ |
| 2026-02-17 | Use Cases Î¼ÎµÏ„Î±Ï†Î­ÏÎ¸Î·ÎºÎ±Î½ ÏƒÎµ Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„ÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ (UC-DXF-AI-use-cases.md) | Claude |
| 2026-02-17 | Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ADR-186 (Building Code / ÎÎŸÎš Module) | Claude + Î“Î¹ÏÏÎ³Î¿Ï‚ |
| 2026-02-17 | ÎˆÏÎµÏ…Î½Î± #1: Geometry libraries, Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® AI-CAD, performance patterns | Claude |
| 2026-02-17 | ÎˆÏÎµÏ…Î½Î± #2: AI Provider abstraction, Vercel AI SDK, vendor lock-in avoidance | Claude + Î“Î¹ÏÏÎ³Î¿Ï‚ |
| 2026-02-17 | Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· sections 6.5-6.8: Geometry Engine, Provider Abstraction, Performance, References | Claude |
| 2026-02-17 | ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î³ÏÎ±Î¼Î¼Î®-Î³ÏÎ±Î¼Î¼Î®: 11 Î½Î­ÎµÏ‚ ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚ (Q-12 â†’ Q-21), 2 Î±Î½Ï„Î¹Ï†Î¬ÏƒÎµÎ¹Ï‚ (C-01, C-02), fix Ï„Î¯Ï„Î»Î¿Ï… Section 3.1 | Claude |
| 2026-02-17 | **Phase 1 IMPLEMENTED**: 9 Î½Î­Î± Î±ÏÏ‡ÎµÎ¯Î±, 4 Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î±, 0 TS errors. Tools: draw_line, draw_rectangle, draw_circle, query_entities, undo_action. Single-call OpenAI + client-side executor + chat panel UI. Feature flag gated. | Claude |
